!function(){"use strict";function t(){}const e=t=>t;function n(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(n)}function a(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,n,i){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const i=e.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}(n,i))}function l(t,e,n,i){return t[1]&&i?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](i(e))):n.ctx}function c(t){return null==t?"":t}const u="undefined"!=typeof window;let d=u?()=>window.performance.now():()=>Date.now(),h=u?t=>requestAnimationFrame(t):t;const p=new Set;function f(t){p.forEach(e=>{e.c(t)||(p.delete(e),e.f())}),0!==p.size&&h(f)}function m(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n||null)}function v(t){t.parentNode.removeChild(t)}function y(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function w(t){return document.createTextNode(t)}function x(){return w(" ")}function C(){return w("")}function E(t,e,n,i){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n,i)}function _(t){return function(e){return e.preventDefault(),t.call(this,e)}}function M(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function k(t,e){e=""+e,t.data!==e&&(t.data=e)}function O(t,e,n,i){t.style.setProperty(e,n,i?"important":"")}function D(t,e,n){t.classList[n?"add":"remove"](e)}function T(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}const S=new Set;let L,B=0;function $(t,e,n,i,r,a,o,s=0){const l=16.666/i;let c="{\n";for(let t=0;t<=1;t+=l){const i=e+(n-e)*a(t);c+=100*t+`%{${o(i,1-i)}}\n`}const u=c+`100% {${o(n,1-n)}}\n}`,d=`__svelte_${function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(u)}_${s}`,h=t.ownerDocument;S.add(h);const p=h.__svelte_stylesheet||(h.__svelte_stylesheet=h.head.appendChild(b("style")).sheet),f=h.__svelte_rules||(h.__svelte_rules={});f[d]||(f[d]=!0,p.insertRule(`@keyframes ${d} ${u}`,p.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${d} ${i}ms linear ${r}ms 1 both`,B+=1,d}function z(t,e){const n=(t.style.animation||"").split(", "),i=n.filter(e?t=>t.indexOf(e)<0:t=>-1===t.indexOf("__svelte")),r=n.length-i.length;r&&(t.style.animation=i.join(", "),B-=r,B||h(()=>{B||(S.forEach(t=>{const e=t.__svelte_stylesheet;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),S.clear())}))}function j(t){L=t}function q(){if(!L)throw new Error("Function called outside component initialization");return L}const F=[],N=[],I=[],R=[],H=Promise.resolve();let P=!1;function A(t){I.push(t)}let U=!1;const W=new Set;function X(){if(!U){U=!0;do{for(let t=0;t<F.length;t+=1){const e=F[t];j(e),Y(e.$$)}for(F.length=0;N.length;)N.pop()();for(let t=0;t<I.length;t+=1){const e=I[t];W.has(e)||(W.add(e),e())}I.length=0}while(F.length);for(;R.length;)R.pop()();P=!1,U=!1,W.clear()}}function Y(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}let K;function V(t,e,n){t.dispatchEvent(T(`${e?"intro":"outro"}${n}`))}const Q=new Set;let Z;function G(){Z={r:0,c:[],p:Z}}function J(){Z.r||r(Z.c),Z=Z.p}function tt(t,e){t&&t.i&&(Q.delete(t),t.i(e))}function et(t,e,n,i){if(t&&t.o){if(Q.has(t))return;Q.add(t),Z.c.push(()=>{Q.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}}const nt={duration:0};function it(n,i,o,s){let l=i(n,o),c=s?0:1,u=null,m=null,g=null;function v(){g&&z(n,g)}function y(t,e){const n=t.b-c;return e*=Math.abs(n),{a:c,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function b(i){const{delay:a=0,duration:o=300,easing:s=e,tick:b=t,css:w}=l||nt,x={start:d()+a,b:i};i||(x.group=Z,Z.r+=1),u?m=x:(w&&(v(),g=$(n,c,i,o,a,s,w)),i&&b(0,1),u=y(x,o),A(()=>V(n,i,"start")),function(t){let e;0===p.size&&h(f),new Promise(n=>{p.add(e={c:t,f:n})})}(t=>{if(m&&t>m.start&&(u=y(m,o),m=null,V(n,u.b,"start"),w&&(v(),g=$(n,c,u.b,u.duration,0,s,l.css))),u)if(t>=u.end)b(c=u.b,1-c),V(n,u.b,"end"),m||(u.b?v():--u.group.r||r(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;c=u.a+u.d*s(e/u.duration),b(c,1-c)}return!(!u&&!m)}))}return{run(t){a(l)?(K||(K=Promise.resolve(),K.then(()=>{K=null})),K).then(()=>{l=l(),b(t)}):b(t)},end(){v(),u=m=null}}}function rt(t,e){t.d(1),e.delete(t.key)}function at(t,e,n,i,r,a,o,s,l,c,u,d){let h=t.length,p=a.length,f=h;const m={};for(;f--;)m[t[f].key]=f;const g=[],v=new Map,y=new Map;for(f=p;f--;){const t=d(r,a,f),s=n(t);let l=o.get(s);l?i&&l.p(t,e):(l=c(s,t),l.c()),v.set(s,g[f]=l),s in m&&y.set(s,Math.abs(f-m[s]))}const b=new Set,w=new Set;function x(t){tt(t,1),t.m(s,u,o.has(t.key)),o.set(t.key,t),u=t.first,p--}for(;h&&p;){const e=g[p-1],n=t[h-1],i=e.key,r=n.key;e===n?(u=e.first,h--,p--):v.has(r)?!o.has(i)||b.has(i)?x(e):w.has(r)?h--:y.get(i)>y.get(r)?(w.add(i),x(e)):(b.add(r),h--):(l(n,o),h--)}for(;h--;){const e=t[h];v.has(e.key)||l(e,o)}for(;p;)x(g[p-1]);return g}function ot(t){t&&t.c()}function st(t,e,i){const{fragment:o,on_mount:s,on_destroy:l,after_update:c}=t.$$;o&&o.m(e,i),A(()=>{const e=s.map(n).filter(a);l?l.push(...e):r(e),t.$$.on_mount=[]}),c.forEach(A)}function lt(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(t,e){-1===t.$$.dirty[0]&&(F.push(t),P||(P=!0,H.then(X)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(e,n,a,o,s,l,c=[-1]){const u=L;j(e);const d=n.props||{},h=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:i(),dirty:c};let p=!1;if(h.ctx=a?a(e,d,(t,n,...i)=>{const r=i.length?i[0]:n;return h.ctx&&s(h.ctx[t],h.ctx[t]=r)&&(h.bound[t]&&h.bound[t](r),p&&ct(e,t)),n}):[],h.update(),p=!0,r(h.before_update),h.fragment=!!o&&o(h.ctx),n.target){if(n.hydrate){const t=function(t){return Array.from(t.childNodes)}(n.target);h.fragment&&h.fragment.l(t),t.forEach(v)}else h.fragment&&h.fragment.c();n.intro&&tt(e.$$.fragment),st(e,n.target,n.anchor),X()}j(u)}class dt{$destroy(){lt(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}var ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var pt={arrayKeyExists:function(t,e){return t in e},b64toBlob:function(t,e,n){e=e||"image/png",n=n||512;for(var i=atob(t),r=[],a=0;a<i.length;a+=n){for(var o=i.slice(a,a+n),s=new Array(o.length),l=0;l<o.length;l++)s[l]=o.charCodeAt(l);var c=new Uint8Array(s);r.push(c)}return new Blob(r,{type:e})},basename:function(t,e=!0){let n=t.split(/[\\/]/).pop();if(!1===e){if(!1===this.str_contains(n,"."))return n;let t=n.split(".");return t.pop(),t.join(".")}return n},compareBlobs:async function(t,e,n=!0){if(t.size!==e.size)return!1;if(!0===n&&t.size>1048576)return!0;let i=await t.arrayBuffer(),r=await e.arrayBuffer();return this._compareBuffers(i,r)},compareObjects:function(t,e){if(null==t||null==e)return t===e;if(t.constructor!==e.constructor)return!1;if(t instanceof Function)return t===e;if(t instanceof RegExp)return t===e;if(t===e||t.valueOf()===e.valueOf())return!0;if(Array.isArray(t)&&t.length!==e.length)return!1;if(t instanceof Date)return!1;if(!(t instanceof Object))return!1;if(!(e instanceof Object))return!1;var n=Object.keys(t);return Object.keys(e).every(t=>-1!==n.indexOf(t))&&n.every(n=>this.compareObjects(t[n],e[n]))},cssId:function(t="jsx"){return t+"-"+this.getRandomNumber(0,1e6)},dirname:function(t){var e=t.replace(/\\/g,"/").replace(/\/[^/]*\/?$/,"");return"/"===e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e},escapeHtml:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,(function(t){return e[t]}))},extend:function(){var t={},e=!1,n=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(e=arguments[0],n++);for(var r=n=>{for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e&&"[object Object]"===Object.prototype.toString.call(n[i])?t[i]=this.extend(!0,t[i],n[i]):t[i]=n[i])};n<i;n++){var a=arguments[n];r(a)}return t},fetchBlob:async function(t,e={}){let n=await fetch(t,e);if(!1===n.ok)throw new Error(`Unexpected response with status ${n.status}: ${n.statusText}.`);return await n.blob()},fetchJson:async function(t,e={}){let n=await fetch(t,e);if(!1===n.ok)throw new Error(`Unexpected response with status ${n.status}: ${n.statusText}.`);return await n.json()},getFileExtension:function(t){return!1===this.str_contains(t,".")?"":t.split(".").pop()},getRandomNumber:function(t,e){return Math.floor(Math.random()*e)+t},humanSize:function(t,e){if(0===t)return"0 Bytes";var n=e||2,i=Math.floor(Math.log(t)/Math.log(1024));return parseFloat((t/Math.pow(1024,i)).toFixed(n))+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},inArray:function(t,e){for(var n=e.length,i=0;i<n;i++)if(t===e[i])return!0;return!1},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},isPlainObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)},mimeIsImage:function(t){return!!t.match(/^image\//)},objectToQueryString:function(t,e){return this._serialize(t,e)},async post(t,e){var n=null;if(e instanceof FormData)n=e;else{if(!this.isPlainObject(e))throw console.error(e),new Error("Unknown payload case.");if(!0===e.hasOwnProperty("post")&&!0===e.hasOwnProperty("get")&&!0===e.hasOwnProperty("files")){var i=e.post,r=e.get,a=e.files;!1===this.isEmptyObject(r)&&(t=this.url_merge_params(t,r)),n=new FormData,this.toFormData(i,n),this.toFormData(a,n)}else n=this.toFormData(e)}return await fetch(t,{method:"POST",body:n})},queryStringToObject:function(t){let e=t.split("?").pop(),n={};return this._parse_str(e,n),n},reindex:function(t){return t.filter((function(t){return void 0!==t}))},removeEntryByIndex:function(t,e){t.splice(e,1)},startsWith:function(t,e){return t.substring(0,e.length)===e},str_contains:function(t,e){return-1!==t.indexOf(e)},toBool:function(t){return"0"!==t&&!!t},toFormData:function(t,e=null){var n;return null===e&&(e=new FormData),(n=t=>e=>e(n=>t(t)(e)(n)))(n)(t=>e=>n=>i=>(i instanceof Object&&Object.keys(i).forEach(r=>{const a=i[r];if(n&&(r=`${n}[${r}]`),!(!(a instanceof Object)||a instanceof Date||a instanceof File))return t(e)(r)(a);e.append(r,a)}),e))(e)()(t)},toInt:function(t){if(!0===t)return 1;if(!1===t)return 0;let e=parseInt(t);return isNaN(e)?0:e},uploadFileProgress:async function(t,e,n,i){return new Promise((r,a)=>{let o;if(e instanceof FormData)o=e;else{o=new FormData;for(let t in e)o.append(t,e[t])}var s=new XMLHttpRequest;this.isFunction(i)&&i(s),s.upload.addEventListener("progress",(function(t){var e=Math.round(t.loaded/t.total*100,2);n(t,e,t.loaded,t.total)}),!1),s.addEventListener("load",(function(t){t.stopPropagation(),t.preventDefault()}),!1),s.addEventListener("error",(function(t){t.stopPropagation(),t.preventDefault(),"onError"in options&&a(t)}),!1),s.addEventListener("abort",(function(t){t.stopPropagation(),t.preventDefault(),"onAbort"in options&&a(t)}),!1),s.open("POST",t),s.onreadystatechange=function(){4===s.readyState&&r(s)},s.send(o)})},url_merge_params:function(t,e,n=!0){let i=t.split("?",2),r="",a=i.shift();1===i.length&&(r=i.shift());let o=this.queryStringToObject(r),s=this.extend(o,e),l=this.objectToQueryString(s,n);return l.length>0&&(a+="?"+l),a},_serialize:function(t,e,n){var i,r=[];for(i in t)if(t.hasOwnProperty(i)){var a=n?n+"["+i+"]":i,o=t[i];null!==o&&"object"==typeof o?r.push(this._serialize(o,e,a)):!0===e?r.push(encodeURIComponent(a)+"="+encodeURIComponent(o)):r.push(a+"="+o)}return r.join("&")},_testTypes:function(){console.log(Object.prototype.toString.call([])),console.log(Object.prototype.toString.call({})),console.log(Object.prototype.toString.call("")),console.log(Object.prototype.toString.call(new Date)),console.log(Object.prototype.toString.call(1)),console.log(Object.prototype.toString.call((function(){}))),console.log(Object.prototype.toString.call(/test/i)),console.log(Object.prototype.toString.call(!0)),console.log(Object.prototype.toString.call(null)),console.log(Object.prototype.toString.call())},_compareBuffers:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const n=new DataView(t),i=new DataView(e);for(var r=t.byteLength;r--;)if(n.getUint8(r)!==i.getUint8(r))return!1;return!0},_parse_str:function(t,e){var n,i,r,a,o,s,l,c,u,d,h,p,f,m=String(t).replace(/^&/,"").replace(/&$/,"").split("&"),g=m.length,v=function(t){return decodeURIComponent(t.replace(/\+/g,"%20"))},y="undefined"!=typeof window?window:ht;y.$locutus=y.$locutus||{};var b=y.$locutus;for(b.php=b.php||{},e||(e=y),n=0;n<g;n++){for(u=v((c=m[n].split("="))[0]),d=c.length<2?"":v(c[1]);" "===u.charAt(0);)u=u.slice(1);if(u.indexOf("\0")>-1&&(u=u.slice(0,u.indexOf("\0"))),u&&"["!==u.charAt(0)){for(p=[],h=0,i=0;i<u.length;i++)if("["!==u.charAt(i)||h){if("]"===u.charAt(i)&&h&&(p.length||p.push(u.slice(0,h-1)),p.push(u.substr(h,i-h)),h=0,"["!==u.charAt(i+1)))break}else h=i+1;for(p.length||(p=[u]),i=0;i<p[0].length&&(" "!==(l=p[0].charAt(i))&&"."!==l&&"["!==l||(p[0]=p[0].substr(0,i)+"_"+p[0].substr(i+1)),"["!==l);i++);for(s=e,i=0,f=p.length;i<f;i++){if(o=s,(""===(u=p[i].replace(/^['"]/,"").replace(/['"]$/,""))||" "===u)&&0!==i){for(a in r=-1,s)s.hasOwnProperty(a)&&+a>r&&a.match(/^\d+$/g)&&(r=+a);u=r+1}Object(s[u])!==s[u]&&(s[u]={}),s=s[u]}o[u]=d}}}},ft=function(t){return t.replace(/__panda_comma__/g,",",t).trim()};function mt(t,e){var n={};for(let a of t){var[i,r]=a;if("panda__arrays"!==i&&pt.startsWith(i,"panda_"))if(i=i.substr(6),pt.inArray(i,e)){!1===pt.arrayKeyExists(i,n)&&(n[i]=[]);let t=r.split(",");for(let e in t){let r=ft(t[e]);n[i].push(r)}}else r=ft(r),n[i]=r}return n}var gt={getPandaHeaders:function(t){var e=[];return t.has("panda__arrays")&&(e=t.get("panda__arrays").split(",")),mt(t,e)},getPandaHeadersByXMLHttpRequest:function(t){var e=t.getAllResponseHeaders().trim().split(/[\r\n]+/),n={};e.forEach((function(t){let e=t.split(": "),i=e.shift(),r=e.join(": ");n[i]=r}));var i=[];return"panda__arrays"in n&&(i=n.panda__arrays.split(",")),mt(Object.entries(n),i)}};class vt{constructor(){this.events=null,this.rules=[],this.translatee=null}addRule(t){this.rules.push(t)}setTranslator(t){this.translatee=t}test(t){var e;for(var n in this.rules){if(!0!==(e=(0,this.rules[n])(t)))return e}return!0}init(t){if(t.hasOwnProperty("maxFileSize")&&-1!==t.maxFileSize&&this.addRule(e=>{if(e.size>t.maxFileSize){var n={fileName:"<strong>"+e.name+"</strong>",maxSize:pt.humanSize(t.maxFileSize),fileSize:pt.humanSize(e.size)};return this.translatee._("err.maxFileExceeded",n)}return!0}),t.hasOwnProperty("maxFileNameLength")&&this.addRule(e=>{if(e.name.length>t.maxFileNameLength){var n={fileName:"<strong>"+e.name+"</strong>",maxLength:t.maxFileNameLength,length:e.name.length};return this.translatee._("err.maxFileNameLength",n)}return!0}),t.hasOwnProperty("mimeType")&&null!==t.mimeType){var e=t.mimeType;"string"==typeof e&&(e=[e]),this.addRule(t=>{if(-1===e.indexOf(t.type)){var n={fileName:"<strong>"+t.name+"</strong>",fileMimeType:"<strong>"+t.type+"</strong>",allowedMimeTypes:e.join(", ")};return this.translatee._("err.wrongMimeType",n)}return!0})}if(t.hasOwnProperty("allowedFileExtension")&&null!==t.allowedFileExtension){var n=t.allowedFileExtension;"string"==typeof n&&(n=[n]),this.addRule(t=>{t.name;var e=pt.getFileExtension(t.name);if(-1===n.indexOf(e)){var i={fileName:"<strong>"+t.name+"</strong>",fileExtension:"<strong>"+e+"</strong>",allowedFileExtensions:n.join(", ")};return this.translatee._("err.wrongFileExtension",i)}return!0})}}}class yt{constructor(){this.nbItems=0,this.totalWeight=0,this.slots={}}registerItems(t){this.nbItems=0,this.totalWeight=0,this.slots={};for(let e of t)2===e.status&&(this.slots[e.id]=0,this.totalWeight+=e.size,this.nbItems++)}addProgress(t,e){var n=Math.round(100/this.nbItems,2);this.slots[t]=e*n/100}getPercent(){var t=0;for(var e in this.slots)t+=this.slots[e];return t}getTotalWeight(){return this.totalWeight}}var bt=class{constructor(){this.dictionaries={},this.pluralSelectors={},this.defaultLang="eng",this.strictMode=!0}setDefaultLang(t){this.defaultLang=t}setStrictMode(t){this.strictMode=t}addDictionary(t,e,n=null){null===n&&(n=this._getDefaultPluralSelector(t)),this.pluralSelectors[t]=n,this.dictionaries[t]=e}_(t,e={},n=null){if(null===n&&(n=this.defaultLang),n in this.dictionaries){var i=this.dictionaries[n];if(t in i){var r=i[t][0];for(var a in e)r=r.replace("{"+a+"}",e[a]);return r}return!0===this.strictMode&&this._error(`Message not found with id = ${t} and langId = ${n}.`),t}return!0===this.strictMode&&this._error(`Dictionary not loaded with langId = ${n}.`),t}_n(t,e,n={},i=null){if(null===i&&(i=this.defaultLang),i in this.dictionaries){var r=this.dictionaries[i];if(t in r){var a=(0,this.pluralSelectors[i])(e);if(a<r[t].length){var o=r[t][a];for(var s in n)o=o.replace("{"+s+"}",n[s]);return o=o.replace("{x}",e)}return!0===this.strictMode&&this._error(`Plural form not found with id = ${t}, pluralIndex=${a} and langId = ${i}.`),t}return!0===this.strictMode&&this._error(`Message not found with id = ${t} and langId = ${i}.`),t}return!0===this.strictMode&&this._error(`Dictionary not loaded with langId = ${i}.`),t}_error(t){throw new Error("Translatee error: "+t)}_getDefaultPluralSelector(t){switch(t){case"en":case"eng":case"fr":case"fra":default:return function(t){return 1===t?0:1}}}};var wt=class{constructor(t){this.options=Object.assign({container:null,cssClass:"dropzone-hover",onDrop:function(t){console.log("the files have been dropped.",t)}},t),this.container=this.options.container}start(){const t=this.options.cssClass,e=this.options.onDrop,n=this.container;n.addEventListener("dragstart",(function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.effectAllowed="copyMove"}),!1),n.addEventListener("dragenter",(function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}),!1),n.addEventListener("dragleave",(function(e){e.stopPropagation(),e.preventDefault(),n.classList.remove(t)}),!1),n.addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault(),!1===n.classList.contains(t)&&n.classList.add(t),e.dataTransfer.dropEffect="copy"}),!1),n.addEventListener("drop",(function(i){i.stopPropagation(),i.preventDefault(),n.classList.remove(t);const r=i.dataTransfer.files;let a=[];for(let t=0;t<r.length;t++)a.push(r[t]);e(a)}),!1)}};var xt=class{constructor(t){this.timer=t.timer||1,this.sliceSize=t.chunkSize||5242880,this.serverUrl=t.serverUrl||"/chunk-uploader.php",this.onChunkLoaded=t.onChunkLoaded||function(t,e,n,i){let r=Math.round(e/n*100,2);console.log(r+"% of the chunks loaded")},this.onChunkAborted=t.onChunkAborted||function(t,e,n){console.log(`The chunk has been aborted: ${t}-${e}, isLastChunk=${n}.`)},this.onChunkResponseReceived=t.onChunkResponseReceived||async function(t){return!0},this._xhr=null,this.controller=new AbortController,this._is_aborted=!1,this._chunkFailed=!1}abort(){this._is_aborted=!0,null!==this._xhr?this._xhr.abort():this.controller.abort()}async sendByChunks(t,e,n){var i=n.start||0;return this._is_aborted=!1,this._chunkFailed=!1,new Promise((n,r)=>{var a=this,o=t.size;setTimeout((async function s(){var l=!1,c=i+a.sliceSize;o-c<=0&&(l=!0,c=o);var u=a._slice(t,i,c);!1===a._chunkFailed&&(await a._send(n,r,u,i,c,o,l,e),c<o&&(i+=a.sliceSize,setTimeout(s,a.timer)))}),this.timer)})}async _send(t,e,n,i,r,a,o,s){var l=new FormData;return l.append("start",i),l.append("end",r),l.append("file",n),l.append("last_chunk",o?1:0),l=pt.toFormData(s,l),this._sendViaFetch(t,e,l,i,r,a,o)}_slice(t,e,n){return(t.mozSlice?t.mozSlice:t.webkitSlice?t.webkitSlice:t.slice?t.slice:this._noop).bind(t)(e,n)}_noop(){}_sendViaFetch(t,e,n,i,r,a,o){return new Promise(async(e,s)=>{let l=`ChunkUploader: an error occurred with the chunk request (start:${i}, end: ${r}).`;var c=await fetch(this.serverUrl,{body:n,method:"POST",signal:this.controller.signal}).catch(t=>{!0===this._is_aborted?this.onChunkAborted(i,r,o):s(l)});if(!0===this._is_aborted)this.onChunkAborted(i,r,o);else if(!0===c.ok){let n=await this.onChunkResponseReceived(c.clone());!0===n?(this.onChunkLoaded(i,r,a,o),e(),!0===o&&t(c)):("string"==typeof n&&(l=n),s(l))}else s(l)}).catch(t=>{e(t),this._chunkFailed=!0})}_sendViaXMLHttpRequest(t,e,n,i,r,a,o){return new Promise((s,l)=>{var c=new XMLHttpRequest;this._xhr=c,c.open("POST",this.serverUrl,!0),c.addEventListener("error",t=>{t.stopPropagation(),t.preventDefault();let n=`ChunkUploader: an error occurred with the chunk request (start:${i}, end: ${r}).`;l(n),e(n)},!1),c.onreadystatechange=()=>{4===c.readyState&&(this.onChunkLoaded(i,r,a,o),s(),!0===o&&t(c))},c.send(n)})}},Ct=function(t,e){return Array.prototype.slice.call(t,e)},Et="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){setTimeout(t,0)},_t=function(t,e,n){t&&Et((function(){t.apply(n||null,e||[])}))},Mt=function(t,e){var n=e||{},i={};return void 0===t&&(t={}),t.on=function(e,n){return i[e]?i[e].push(n):i[e]=[n],t},t.once=function(e,n){return n._once=!0,t.on(e,n),t},t.off=function(e,n){var r=arguments.length;if(1===r)delete i[e];else if(0===r)i={};else{var a=i[e];if(!a)return t;a.splice(a.indexOf(n),1)}return t},t.emit=function(){var e=Ct(arguments);return t.emitterSnapshot(e.shift()).apply(this,e)},t.emitterSnapshot=function(e){var r=(i[e]||[]).slice(0);return function(){var i=Ct(arguments),a=this||t;if("error"===e&&!1!==n.throws&&!r.length)throw 1===i.length?i[0]:i;return r.forEach((function(r){n.async?_t(r,i,a):r.apply(a,i),r._once&&t.off(e,r)})),t}},t},kt=ht.CustomEvent;var Ot=function(){try{var t=new kt("cat",{detail:{foo:"bar"}});return"cat"===t.type&&"bar"===t.detail.foo}catch(t){}return!1}()?kt:"function"==typeof document.createEvent?function(t,e){var n=document.createEvent("CustomEvent");return e?n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail):n.initCustomEvent(t,!1,!1,void 0),n}:function(t,e){var n=document.createEventObject();return n.type=t,e?(n.bubbles=Boolean(e.bubbles),n.cancelable=Boolean(e.cancelable),n.detail=e.detail):(n.bubbles=!1,n.cancelable=!1,n.detail=void 0),n},Dt=[],Tt="",St=/^on/;for(Tt in ht)St.test(Tt)&&Dt.push(Tt.slice(2));var Lt=Dt,Bt=ht.document,$t=function(t,e,n,i){return t.addEventListener(e,n,i)},zt=function(t,e,n,i){return t.removeEventListener(e,n,i)},jt=[];ht.addEventListener||($t=function(t,e,n){return t.attachEvent("on"+e,function(t,e,n){var i=Ft(t,e,n)||function(t,e,n){return function(e){var i=e||ht.event;i.target=i.target||i.srcElement,i.preventDefault=i.preventDefault||function(){i.returnValue=!1},i.stopPropagation=i.stopPropagation||function(){i.cancelBubble=!0},i.which=i.which||i.keyCode,n.call(t,i)}}(t,0,n);return jt.push({wrapper:i,element:t,type:e,fn:n}),i}(t,e,n))},zt=function(t,e,n){var i=Ft(t,e,n);if(i)return t.detachEvent("on"+e,i)});var qt={add:$t,remove:zt,fabricate:function(t,e,n){var i=-1===Lt.indexOf(e)?new Ot(e,{detail:n}):function(){var t;Bt.createEvent?(t=Bt.createEvent("Event")).initEvent(e,!0,!0):Bt.createEventObject&&(t=Bt.createEventObject());return t}();t.dispatchEvent?t.dispatchEvent(i):t.fireEvent("on"+e,i)}};function Ft(t,e,n){var i=function(t,e,n){var i,r;for(i=0;i<jt.length;i++)if((r=jt[i]).element===t&&r.type===e&&r.fn===n)return i}(t,e,n);if(i){var r=jt[i].wrapper;return jt.splice(i,1),r}}var Nt={};function It(t){var e=Nt[t];return e?e.lastIndex=0:Nt[t]=e=new RegExp("(?:^|\\s)"+t+"(?:\\s|$)","g"),e}var Rt={add:function(t,e){var n=t.className;n.length?It(e).test(n)||(t.className+=" "+e):t.className=e},rm:function(t,e){t.className=t.className.replace(It(e)," ").trim()}},Ht=document,Pt=Ht.documentElement;function At(t,e,n,i){ht.navigator.pointerEnabled?qt[e](t,{mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"}[n],i):ht.navigator.msPointerEnabled?qt[e](t,{mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"}[n],i):(qt[e](t,{mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"}[n],i),qt[e](t,n,i))}function Ut(t){if(void 0!==t.touches)return t.touches.length;if(void 0!==t.which&&0!==t.which)return t.which;if(void 0!==t.buttons)return t.buttons;var e=t.button;return void 0!==e?1&e?1:2&e?3:4&e?2:0:void 0}function Wt(t){var e=t.getBoundingClientRect();return{left:e.left+Xt("scrollLeft","pageXOffset"),top:e.top+Xt("scrollTop","pageYOffset")}}function Xt(t,e){return void 0!==ht[e]?ht[e]:Pt.clientHeight?Pt[t]:Ht.body[t]}function Yt(t,e,n){var i,r=t||{},a=r.className;return r.className+=" gu-hide",i=Ht.elementFromPoint(e,n),r.className=a,i}function Kt(){return!1}function Vt(){return!0}function Qt(t){return t.width||t.right-t.left}function Zt(t){return t.height||t.bottom-t.top}function Gt(t){return t.parentNode===Ht?null:t.parentNode}function Jt(t){return"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||function t(e){if(!e)return!1;if("false"===e.contentEditable)return!1;if("true"===e.contentEditable)return!0;return t(Gt(e))}(t)}function te(t){return t.nextElementSibling||function(){var e=t;do{e=e.nextSibling}while(e&&1!==e.nodeType);return e}()}function ee(t,e){var n=function(t){return t.targetTouches&&t.targetTouches.length?t.targetTouches[0]:t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t}(e),i={pageX:"clientX",pageY:"clientY"};return t in i&&!(t in n)&&i[t]in n&&(t=i[t]),n[t]}var ne=function(t,e){var n,i,r,a,o,s,l,c,u,d,h,p=arguments.length;1===p&&!1===Array.isArray(t)&&(e=t,t=[]);var f,m=null,g=e||{};void 0===g.moves&&(g.moves=Vt),void 0===g.accepts&&(g.accepts=Vt),void 0===g.invalid&&(g.invalid=S),void 0===g.containers&&(g.containers=t||[]),void 0===g.isContainer&&(g.isContainer=Kt),void 0===g.copy&&(g.copy=!1),void 0===g.copySortSource&&(g.copySortSource=!1),void 0===g.revertOnSpill&&(g.revertOnSpill=!1),void 0===g.removeOnSpill&&(g.removeOnSpill=!1),void 0===g.direction&&(g.direction="vertical"),void 0===g.ignoreInputTextSelection&&(g.ignoreInputTextSelection=!0),void 0===g.mirrorContainer&&(g.mirrorContainer=Ht.body);var v=Mt({containers:g.containers,start:D,end:L,cancel:q,remove:j,destroy:C,canMove:O,dragging:!1});return!0===g.removeOnSpill&&v.on("over",H).on("out",P),b(),v;function y(t){return-1!==v.containers.indexOf(t)||g.isContainer(t)}function b(t){var e=t?"remove":"add";At(Pt,e,"mousedown",_),At(Pt,e,"mouseup",$)}function w(t){At(Pt,t?"remove":"add","mousemove",M)}function x(t){var e=t?"remove":"add";qt[e](Pt,"selectstart",E),qt[e](Pt,"click",E)}function C(){b(!0),$({})}function E(t){f&&t.preventDefault()}function _(t){if(s=t.clientX,l=t.clientY,!(1!==Ut(t)||t.metaKey||t.ctrlKey)){var e=t.target,n=k(e);n&&(f=n,w(),"mousedown"===t.type&&(Jt(e)?e.focus():t.preventDefault()))}}function M(t){if(f)if(0!==Ut(t)){if(void 0===t.clientX||t.clientX!==s||void 0===t.clientY||t.clientY!==l){if(g.ignoreInputTextSelection){var e=ee("clientX",t),n=ee("clientY",t);if(Jt(Ht.elementFromPoint(e,n)))return}var i=f;w(!0),x(),L(),T(i);var c=Wt(r);a=ee("pageX",t)-c.left,o=ee("pageY",t)-c.top,Rt.add(d||r,"gu-transit"),A(),R(t)}}else $({})}function k(t){if(!(v.dragging&&n||y(t))){for(var e=t;Gt(t)&&!1===y(Gt(t));){if(g.invalid(t,e))return;if(!(t=Gt(t)))return}var i=Gt(t);if(i)if(!g.invalid(t,e))if(g.moves(t,i,e,te(t)))return{item:t,source:i}}}function O(t){return!!k(t)}function D(t){var e=k(t);e&&T(e)}function T(t){Y(t.item,t.source)&&(d=t.item.cloneNode(!0),v.emit("cloned",d,t.item,"copy")),i=t.source,r=t.item,c=u=te(t.item),v.dragging=!0,v.emit("drag",r,i)}function S(){return!1}function L(){if(v.dragging){var t=d||r;z(t,Gt(t))}}function B(){f=!1,w(!0),x(!0)}function $(t){if(B(),v.dragging){var e=d||r,a=ee("clientX",t),o=ee("clientY",t),s=I(Yt(n,a,o),a,o);s&&(d&&g.copySortSource||!d||s!==i)?z(e,s):g.removeOnSpill?j():q()}}function z(t,e){var n=Gt(t);d&&g.copySortSource&&e===i&&n.removeChild(r),N(e)?v.emit("cancel",t,i,i):v.emit("drop",t,e,i,u),F()}function j(){if(v.dragging){var t=d||r,e=Gt(t);e&&e.removeChild(t),v.emit(d?"cancel":"remove",t,e,i),F()}}function q(t){if(v.dragging){var e=arguments.length>0?t:g.revertOnSpill,n=d||r,a=Gt(n),o=N(a);!1===o&&e&&(d?a&&a.removeChild(d):i.insertBefore(n,c)),o||e?v.emit("cancel",n,i,i):v.emit("drop",n,a,i,u),F()}}function F(){var t=d||r;B(),U(),t&&Rt.rm(t,"gu-transit"),h&&clearTimeout(h),v.dragging=!1,m&&v.emit("out",t,m,i),v.emit("dragend",t),i=r=d=c=u=h=m=null}function N(t,e){var a;return a=void 0!==e?e:n?u:te(d||r),t===i&&a===c}function I(t,e,n){for(var a=t;a&&!o();)a=Gt(a);return a;function o(){if(!1===y(a))return!1;var o=W(a,t),s=X(a,o,e,n);return!!N(a,s)||g.accepts(r,a,i,s)}}function R(t){if(n){t.preventDefault();var e=ee("clientX",t),s=ee("clientY",t),l=e-a,h=s-o;n.style.left=l+"px",n.style.top=h+"px";var p=d||r,f=Yt(n,e,s),y=I(f,e,s),b=null!==y&&y!==m;(b||null===y)&&(m&&E("out"),m=y,b&&E("over"));var w=Gt(p);if(y!==i||!d||g.copySortSource){var x,C=W(y,f);if(null!==C)x=X(y,C,e,s);else{if(!0!==g.revertOnSpill||d)return void(d&&w&&w.removeChild(p));x=c,y=i}(null===x&&b||x!==p&&x!==te(p))&&(u=x,y.insertBefore(p,x),v.emit("shadow",p,y,i))}else w&&w.removeChild(p)}function E(t){v.emit(t,p,m,i)}}function H(t){Rt.rm(t,"gu-hide")}function P(t){v.dragging&&Rt.add(t,"gu-hide")}function A(){if(!n){var t=r.getBoundingClientRect();(n=r.cloneNode(!0)).style.width=Qt(t)+"px",n.style.height=Zt(t)+"px",Rt.rm(n,"gu-transit"),Rt.add(n,"gu-mirror"),g.mirrorContainer.appendChild(n),At(Pt,"add","mousemove",R),Rt.add(g.mirrorContainer,"gu-unselectable"),v.emit("cloned",n,r,"mirror")}}function U(){n&&(Rt.rm(g.mirrorContainer,"gu-unselectable"),At(Pt,"remove","mousemove",R),Gt(n).removeChild(n),n=null)}function W(t,e){for(var n=e;n!==t&&Gt(n)!==t;)n=Gt(n);return n===Pt?null:n}function X(t,e,n,i){var r="horizontal"===g.direction;return e!==t?function(){var t=e.getBoundingClientRect();if(r)return a(n>t.left+Qt(t)/2);return a(i>t.top+Zt(t)/2)}():function(){var e,a,o,s=t.children.length;for(e=0;e<s;e++){if(a=t.children[e],o=a.getBoundingClientRect(),r&&o.left+o.width/2>n)return a;if(!r&&o.top+o.height/2>i)return a}return null}();function a(t){return t?te(e):e}}function Y(t,e){return"boolean"==typeof g.copy?g.copy:g.copy(t,e)}};function ie(t,{delay:n=0,duration:i=400,easing:r=e}){const a=+getComputedStyle(t).opacity;return{delay:n,duration:i,easing:r,css:t=>"opacity: "+t*a}}const re=[];function ae(t,e={}){let n,i,r=Object.assign({startClick:"main",onStartDragBefore:function(t){}},e),a=!1;function o(e){let o=r.startClick;!1===Array.isArray(r.startClick)&&(o=[r.startClick]),o=o.map(t=>{let e;switch(t){case"main":e=0;break;case"aux":e=1;break;case"secondary":e=2}return e}),!1!==o.includes(e.button)&&!1!==r.onStartDragBefore(e)&&(a=!0,n=e.clientX,i=e.clientY,t.dispatchEvent(new CustomEvent("dragstart",{detail:{x:n,y:i}})),window.addEventListener("mousemove",s),window.addEventListener("mouseup",l))}function s(e){if(!1===a)return;const r=e.clientX-n,o=e.clientY-i;n=e.clientX,i=e.clientY,t.dispatchEvent(new CustomEvent("dragmove",{detail:{x:n,y:i,dx:r,dy:o}}))}function l(e){a=!1,n=e.clientX,i=e.clientY,t.dispatchEvent(new CustomEvent("dragend",{detail:{x:n,y:i}})),window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",l)}return t.addEventListener("mousedown",o),{destroy(){t.removeEventListener("mousedown",o)}}}function oe(e){let n,i,o,s,c;const u=e[16].default,d=function(t,e,n,i){if(t){const r=l(t,e,n,i);return t[0](r)}}(u,e,e[15],null);return{c(){n=b("div"),d&&d.c(),M(n,"style",i="\n        "+e[0]+"\n        transform: translate("+e[1].x+"px,"+e[1].y+"px)\n        ")},m(i,l,u){var h;g(i,n,l),d&&d.m(n,null),s=!0,u&&r(c),c=[(h=o=ae.call(null,n,e[3]),h&&a(h.destroy)?h.destroy:t),E(n,"dragstart",e[5]),E(n,"dragmove",e[4]),E(n,"dragend",le)]},p(t,[e]){d&&d.p&&32768&e&&d.p(l(u,t,t[15],null),function(t,e,n,i){if(t[2]&&i){const r=t[2](i(n));if(void 0===e.dirty)return r;if("object"==typeof r){const t=[],n=Math.max(e.dirty.length,r.length);for(let i=0;i<n;i+=1)t[i]=e.dirty[i]|r[i];return t}return e.dirty|r}return e.dirty}(u,t[15],e,null)),(!s||3&e&&i!==(i="\n        "+t[0]+"\n        transform: translate("+t[1].x+"px,"+t[1].y+"px)\n        "))&&M(n,"style",i)},i(t){s||(tt(d,t),s=!0)},o(t){et(d,t),s=!1},d(t){t&&v(n),d&&d.d(t),r(c)}}}const se="my-draggable-tmp-style";function le(t){this.classList.remove("draggable-unselectable");let e=document.getElementById(se);null!==e&&e.remove()}function ce(e,n,i){let r,{options:a={}}=n,{open:l=!0}=n,c=0,u=0,d=0,h=0;const p=function(e,n=t){let i;const r=[];function a(t){if(o(e,t)&&(e=t,i)){const t=!re.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),re.push(n,e)}if(t){for(let t=0;t<re.length;t+=2)re[t][0](re[t+1]);re.length=0}}}return{set:a,update:function(t){a(t(e))},subscribe:function(o,s=t){const l=[o,s];return r.push(l),1===r.length&&(i=n(a)||t),o(e),()=>{const t=r.indexOf(l);-1!==t&&r.splice(t,1),0===r.length&&(i(),i=null)}}}}({x:0,y:0});s(e,p,t=>i(1,r=t));const f=function(){const t=q();return(e,n)=>{const i=t.$$.callbacks[e];if(i){const r=T(e,n);i.slice().forEach(e=>{e.call(t,r)})}}}();let m={startClick:"main",onStartDragBefore(t){if(null!==v.dragHandle){if(null===t.target.closest(v.dragHandle))return!1}}},g="",v=Object.assign({dragHandle:null,keepInViewport:!0},a);var y;!function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}}(),y=()=>{i(0,g=!0===l?"":"display: none;")},q().$$.before_update.push(y);let{$$slots:b={},$$scope:w}=n;return e.$set=t=>{"options"in t&&i(7,a=t.options),"open"in t&&i(6,l=t.open),"$$scope"in t&&i(15,w=t.$$scope)},[g,r,p,m,function(t){p.update(e=>{let n=e.x+t.detail.dx,i=e.y+t.detail.dy;return!0===v.keepInViewport&&(n<h&&(n=h),n>u&&(n=u),i<c&&(i=c),i>d&&(i=d)),{x:n,y:i}}),f("dragmove",t.detail)},function(t){let e=document.getElementById(se);if(null===e){var n=document.getElementsByTagName("head")[0];e=document.createElement("style"),e.type="text/css",n.appendChild(e),e.id=se,e.innerHTML=".draggable-unselectable > * {user-select: none;}"}if(this.classList.add("draggable-unselectable"),!0===v.keepInViewport){let e=t.target.firstChild.getBoundingClientRect();h=-e.left+r.x,u=window.innerWidth-e.right+r.x,c=-e.top+r.y,d=window.innerHeight-e.bottom+r.y}},l,a,c,u,d,h,f,v,function(){i(6,l=!1)},w,b]}class ue extends dt{constructor(t){super(),ut(this,t,ce,oe,o,{options:7,open:6})}}var de=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){
/*!
     * Cropper.js v1.5.6
     * https://fengyuanchen.github.io/cropperjs
     *
     * Copyright 2015-present Chen Fengyuan
     * Released under the MIT license
     *
     * Date: 2019-10-04T04:33:48.372Z
     */
t.exports=function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(n,!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var s="undefined"!=typeof window&&void 0!==window.document,l=s?window:{},c=!!s&&"ontouchstart"in l.document.documentElement,u=!!s&&"PointerEvent"in l,d="".concat("cropper","-crop"),h="".concat("cropper","-disabled"),p="".concat("cropper","-hidden"),f="".concat("cropper","-hide"),m="".concat("cropper","-invisible"),g="".concat("cropper","-modal"),v="".concat("cropper","-move"),y="".concat("cropper","Action"),b="".concat("cropper","Preview"),w=c?"touchstart":"mousedown",x=c?"touchmove":"mousemove",C=c?"touchend touchcancel":"mouseup",E=u?"pointerdown":w,_=u?"pointermove":x,M=u?"pointerup pointercancel":C,k=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,O=/^data:/,D=/^data:image\/jpeg;base64,/,T=/^img|canvas$/i,S={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},L=Number.isNaN||l.isNaN;function B(t){return"number"==typeof t&&!L(t)}var $=function(t){return t>0&&t<1/0};function z(t){return void 0===t}function j(e){return"object"===t(e)&&null!==e}var q=Object.prototype.hasOwnProperty;function F(t){if(!j(t))return!1;try{var e=t.constructor,n=e.prototype;return e&&n&&q.call(n,"isPrototypeOf")}catch(t){return!1}}function N(t){return"function"==typeof t}var I=Array.prototype.slice;function R(t){return Array.from?Array.from(t):I.call(t)}function H(t,e){return t&&N(e)&&(Array.isArray(t)||B(t.length)?R(t).forEach((function(n,i){e.call(t,n,i,t)})):j(t)&&Object.keys(t).forEach((function(n){e.call(t,t[n],n,t)}))),t}var P=Object.assign||function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return j(t)&&n.length>0&&n.forEach((function(e){j(e)&&Object.keys(e).forEach((function(n){t[n]=e[n]}))})),t},A=/\.\d*(?:0|9){12}\d*$/;function U(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return A.test(t)?Math.round(t*e)/e:t}var W=/^width|height|left|top|marginLeft|marginTop$/;function X(t,e){var n=t.style;H(e,(function(t,e){W.test(e)&&B(t)&&(t="".concat(t,"px")),n[e]=t}))}function Y(t,e){if(e)if(B(t.length))H(t,(function(t){Y(t,e)}));else if(t.classList)t.classList.add(e);else{var n=t.className.trim();n?n.indexOf(e)<0&&(t.className="".concat(n," ").concat(e)):t.className=e}}function K(t,e){e&&(B(t.length)?H(t,(function(t){K(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function V(t,e,n){e&&(B(t.length)?H(t,(function(t){V(t,e,n)})):n?Y(t,e):K(t,e))}var Q=/([a-z\d])([A-Z])/g;function Z(t){return t.replace(Q,"$1-$2").toLowerCase()}function G(t,e){return j(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(Z(e)))}function J(t,e,n){j(n)?t[e]=n:t.dataset?t.dataset[e]=n:t.setAttribute("data-".concat(Z(e)),n)}var tt=/\s\s*/,et=function(){var t=!1;if(s){var e=!1,n=function(){},i=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(t){e=t}});l.addEventListener("test",n,i),l.removeEventListener("test",n,i)}return t}();function nt(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;e.trim().split(tt).forEach((function(e){if(!et){var a=t.listeners;a&&a[e]&&a[e][n]&&(r=a[e][n],delete a[e][n],0===Object.keys(a[e]).length&&delete a[e],0===Object.keys(a).length&&delete t.listeners)}t.removeEventListener(e,r,i)}))}function it(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=n;e.trim().split(tt).forEach((function(e){if(i.once&&!et){var a=t.listeners,o=void 0===a?{}:a;r=function(){delete o[e][n],t.removeEventListener(e,r,i);for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];n.apply(t,s)},o[e]||(o[e]={}),o[e][n]&&t.removeEventListener(e,o[e][n],i),o[e][n]=r,t.listeners=o}t.addEventListener(e,r,i)}))}function rt(t,e,n){var i;return N(Event)&&N(CustomEvent)?i=new CustomEvent(e,{detail:n,bubbles:!0,cancelable:!0}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,n),t.dispatchEvent(i)}function at(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ot=l.location,st=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function lt(t){var e=t.match(st);return null!==e&&(e[1]!==ot.protocol||e[2]!==ot.hostname||e[3]!==ot.port)}function ct(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function ut(t){var e=t.rotate,n=t.scaleX,i=t.scaleY,r=t.translateX,a=t.translateY,o=[];B(r)&&0!==r&&o.push("translateX(".concat(r,"px)")),B(a)&&0!==a&&o.push("translateY(".concat(a,"px)")),B(e)&&0!==e&&o.push("rotate(".concat(e,"deg)")),B(n)&&1!==n&&o.push("scaleX(".concat(n,")")),B(i)&&1!==i&&o.push("scaleY(".concat(i,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function dt(t,e){var n=t.pageX,i=t.pageY,r={endX:n,endY:i};return e?r:a({startX:n,startY:i},r)}function ht(t){var e=t.aspectRatio,n=t.height,i=t.width,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",a=$(i),o=$(n);if(a&&o){var s=n*e;"contain"===r&&s>i||"cover"===r&&s<i?n=i/e:i=n*e}else a?n=i/e:o&&(i=n*e);return{width:i,height:n}}function pt(t,e,n,i){var r=e.aspectRatio,a=e.naturalWidth,s=e.naturalHeight,l=e.rotate,c=void 0===l?0:l,u=e.scaleX,d=void 0===u?1:u,h=e.scaleY,p=void 0===h?1:h,f=n.aspectRatio,m=n.naturalWidth,g=n.naturalHeight,v=i.fillColor,y=void 0===v?"transparent":v,b=i.imageSmoothingEnabled,w=void 0===b||b,x=i.imageSmoothingQuality,C=void 0===x?"low":x,E=i.maxWidth,_=void 0===E?1/0:E,M=i.maxHeight,k=void 0===M?1/0:M,O=i.minWidth,D=void 0===O?0:O,T=i.minHeight,S=void 0===T?0:T,L=document.createElement("canvas"),B=L.getContext("2d"),$=ht({aspectRatio:f,width:_,height:k}),z=ht({aspectRatio:f,width:D,height:S},"cover"),j=Math.min($.width,Math.max(z.width,m)),q=Math.min($.height,Math.max(z.height,g)),F=ht({aspectRatio:r,width:_,height:k}),N=ht({aspectRatio:r,width:D,height:S},"cover"),I=Math.min(F.width,Math.max(N.width,a)),R=Math.min(F.height,Math.max(N.height,s)),H=[-I/2,-R/2,I,R];return L.width=U(j),L.height=U(q),B.fillStyle=y,B.fillRect(0,0,j,q),B.save(),B.translate(j/2,q/2),B.rotate(c*Math.PI/180),B.scale(d,p),B.imageSmoothingEnabled=w,B.imageSmoothingQuality=C,B.drawImage.apply(B,[t].concat(o(H.map((function(t){return Math.floor(U(t))}))))),B.restore(),L}var ft=String.fromCharCode,mt=/^data:.*,/;function gt(t){var e,n=new DataView(t);try{var i,r,a;if(255===n.getUint8(0)&&216===n.getUint8(1))for(var o=n.byteLength,s=2;s+1<o;){if(255===n.getUint8(s)&&225===n.getUint8(s+1)){r=s;break}s+=1}if(r){var l=r+10;if("Exif"===function(t,e,n){var i="";n+=e;for(var r=e;r<n;r+=1)i+=ft(t.getUint8(r));return i}(n,r+4,4)){var c=n.getUint16(l);if(((i=18761===c)||19789===c)&&42===n.getUint16(l+2,i)){var u=n.getUint32(l+4,i);u>=8&&(a=l+u)}}}if(a){var d,h,p=n.getUint16(a,i);for(h=0;h<p;h+=1)if(d=a+12*h+2,274===n.getUint16(d,i)){d+=8,e=n.getUint16(d,i),n.setUint16(d,1,i);break}}}catch(t){e=1}return e}var vt={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,n=this.container,i=this.cropper;Y(i,p),K(t,p);var r={width:Math.max(n.offsetWidth,Number(e.minContainerWidth)||200),height:Math.max(n.offsetHeight,Number(e.minContainerHeight)||100)};this.containerData=r,X(i,{width:r.width,height:r.height}),Y(t,p),K(i,p)},initCanvas:function(){var t=this.containerData,e=this.imageData,n=this.options.viewMode,i=Math.abs(e.rotate)%180==90,r=i?e.naturalHeight:e.naturalWidth,a=i?e.naturalWidth:e.naturalHeight,o=r/a,s=t.width,l=t.height;t.height*o>t.width?3===n?s=t.height*o:l=t.width/o:3===n?l=t.width/o:s=t.height*o;var c={aspectRatio:o,naturalWidth:r,naturalHeight:a,width:s,height:l};c.left=(t.width-s)/2,c.top=(t.height-l)/2,c.oldLeft=c.left,c.oldTop=c.top,this.canvasData=c,this.limited=1===n||2===n,this.limitCanvas(!0,!0),this.initialImageData=P({},e),this.initialCanvasData=P({},c)},limitCanvas:function(t,e){var n=this.options,i=this.containerData,r=this.canvasData,a=this.cropBoxData,o=n.viewMode,s=r.aspectRatio,l=this.cropped&&a;if(t){var c=Number(n.minCanvasWidth)||0,u=Number(n.minCanvasHeight)||0;o>1?(c=Math.max(c,i.width),u=Math.max(u,i.height),3===o&&(u*s>c?c=u*s:u=c/s)):o>0&&(c?c=Math.max(c,l?a.width:0):u?u=Math.max(u,l?a.height:0):l&&(c=a.width,(u=a.height)*s>c?c=u*s:u=c/s));var d=ht({aspectRatio:s,width:c,height:u});c=d.width,u=d.height,r.minWidth=c,r.minHeight=u,r.maxWidth=1/0,r.maxHeight=1/0}if(e)if(o>(l?0:1)){var h=i.width-r.width,p=i.height-r.height;r.minLeft=Math.min(0,h),r.minTop=Math.min(0,p),r.maxLeft=Math.max(0,h),r.maxTop=Math.max(0,p),l&&this.limited&&(r.minLeft=Math.min(a.left,a.left+(a.width-r.width)),r.minTop=Math.min(a.top,a.top+(a.height-r.height)),r.maxLeft=a.left,r.maxTop=a.top,2===o&&(r.width>=i.width&&(r.minLeft=Math.min(0,h),r.maxLeft=Math.max(0,h)),r.height>=i.height&&(r.minTop=Math.min(0,p),r.maxTop=Math.max(0,p))))}else r.minLeft=-r.width,r.minTop=-r.height,r.maxLeft=i.width,r.maxTop=i.height},renderCanvas:function(t,e){var n=this.canvasData,i=this.imageData;if(e){var r=function(t){var e=t.width,n=t.height,i=t.degree;if(90==(i=Math.abs(i)%180))return{width:n,height:e};var r=i%90*Math.PI/180,a=Math.sin(r),o=Math.cos(r),s=e*o+n*a,l=e*a+n*o;return i>90?{width:l,height:s}:{width:s,height:l}}({width:i.naturalWidth*Math.abs(i.scaleX||1),height:i.naturalHeight*Math.abs(i.scaleY||1),degree:i.rotate||0}),a=r.width,o=r.height,s=n.width*(a/n.naturalWidth),l=n.height*(o/n.naturalHeight);n.left-=(s-n.width)/2,n.top-=(l-n.height)/2,n.width=s,n.height=l,n.aspectRatio=a/o,n.naturalWidth=a,n.naturalHeight=o,this.limitCanvas(!0,!1)}(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCanvas(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,X(this.canvas,P({width:n.width,height:n.height},ut({translateX:n.left,translateY:n.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,n=this.imageData,i=n.naturalWidth*(e.width/e.naturalWidth),r=n.naturalHeight*(e.height/e.naturalHeight);P(n,{width:i,height:r,left:(e.width-i)/2,top:(e.height-r)/2}),X(this.image,P({width:n.width,height:n.height},ut(P({translateX:n.left,translateY:n.top},n)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,n=t.aspectRatio||t.initialAspectRatio,i=Number(t.autoCropArea)||.8,r={width:e.width,height:e.height};n&&(e.height*n>e.width?r.height=r.width/n:r.width=r.height*n),this.cropBoxData=r,this.limitCropBox(!0,!0),r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth),r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight),r.width=Math.max(r.minWidth,r.width*i),r.height=Math.max(r.minHeight,r.height*i),r.left=e.left+(e.width-r.width)/2,r.top=e.top+(e.height-r.height)/2,r.oldLeft=r.left,r.oldTop=r.top,this.initialCropBoxData=P({},r)},limitCropBox:function(t,e){var n=this.options,i=this.containerData,r=this.canvasData,a=this.cropBoxData,o=this.limited,s=n.aspectRatio;if(t){var l=Number(n.minCropBoxWidth)||0,c=Number(n.minCropBoxHeight)||0,u=o?Math.min(i.width,r.width,r.width+r.left,i.width-r.left):i.width,d=o?Math.min(i.height,r.height,r.height+r.top,i.height-r.top):i.height;l=Math.min(l,i.width),c=Math.min(c,i.height),s&&(l&&c?c*s>l?c=l/s:l=c*s:l?c=l/s:c&&(l=c*s),d*s>u?d=u/s:u=d*s),a.minWidth=Math.min(l,u),a.minHeight=Math.min(c,d),a.maxWidth=u,a.maxHeight=d}e&&(o?(a.minLeft=Math.max(0,r.left),a.minTop=Math.max(0,r.top),a.maxLeft=Math.min(i.width,r.left+r.width)-a.width,a.maxTop=Math.min(i.height,r.top+r.height)-a.height):(a.minLeft=0,a.minTop=0,a.maxLeft=i.width-a.width,a.maxTop=i.height-a.height))},renderCropBox:function(){var t=this.options,e=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,t.movable&&t.cropBoxMovable&&J(this.face,y,n.width>=e.width&&n.height>=e.height?"move":"all"),X(this.cropBox,P({width:n.width,height:n.height},ut({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),rt(this.element,"crop",this.getData())}},yt={initPreview:function(){var t=this.element,e=this.crossOrigin,n=this.options.preview,i=e?this.crossOriginUrl:this.url,r=t.alt||"The image to preview",a=document.createElement("img");if(e&&(a.crossOrigin=e),a.src=i,a.alt=r,this.viewBox.appendChild(a),this.viewBoxImage=a,n){var o=n;"string"==typeof n?o=t.ownerDocument.querySelectorAll(n):n.querySelector&&(o=[n]),this.previews=o,H(o,(function(t){var n=document.createElement("img");J(t,b,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(n.crossOrigin=e),n.src=i,n.alt=r,n.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(n)}))}},resetPreview:function(){H(this.previews,(function(t){var e=G(t,b);X(t,{width:e.width,height:e.height}),t.innerHTML=e.html,function(t,e){if(j(t[e]))try{delete t[e]}catch(n){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(n){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(Z(e)))}(t,b)}))},preview:function(){var t=this.imageData,e=this.canvasData,n=this.cropBoxData,i=n.width,r=n.height,a=t.width,o=t.height,s=n.left-e.left-t.left,l=n.top-e.top-t.top;this.cropped&&!this.disabled&&(X(this.viewBoxImage,P({width:a,height:o},ut(P({translateX:-s,translateY:-l},t)))),H(this.previews,(function(e){var n=G(e,b),c=n.width,u=n.height,d=c,h=u,p=1;i&&(h=r*(p=c/i)),r&&h>u&&(d=i*(p=u/r),h=u),X(e,{width:d,height:h}),X(e.getElementsByTagName("img")[0],P({width:a*p,height:o*p},ut(P({translateX:-s*p,translateY:-l*p},t))))})))}},bt={bind:function(){var t=this.element,e=this.options,n=this.cropper;N(e.cropstart)&&it(t,"cropstart",e.cropstart),N(e.cropmove)&&it(t,"cropmove",e.cropmove),N(e.cropend)&&it(t,"cropend",e.cropend),N(e.crop)&&it(t,"crop",e.crop),N(e.zoom)&&it(t,"zoom",e.zoom),it(n,E,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&it(n,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&it(n,"dblclick",this.onDblclick=this.dblclick.bind(this)),it(t.ownerDocument,_,this.onCropMove=this.cropMove.bind(this)),it(t.ownerDocument,M,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&it(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,n=this.cropper;N(e.cropstart)&&nt(t,"cropstart",e.cropstart),N(e.cropmove)&&nt(t,"cropmove",e.cropmove),N(e.cropend)&&nt(t,"cropend",e.cropend),N(e.crop)&&nt(t,"crop",e.crop),N(e.zoom)&&nt(t,"zoom",e.zoom),nt(n,E,this.onCropStart),e.zoomable&&e.zoomOnWheel&&nt(n,"wheel",this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&nt(n,"dblclick",this.onDblclick),nt(t.ownerDocument,_,this.onCropMove),nt(t.ownerDocument,M,this.onCropEnd),e.responsive&&nt(window,"resize",this.onResize)}},wt={resize:function(){var t=this.options,e=this.container,n=this.containerData,i=Number(t.minContainerWidth)||200,r=Number(t.minContainerHeight)||100;if(!(this.disabled||n.width<=i||n.height<=r)){var a,o,s=e.offsetWidth/n.width;1===s&&e.offsetHeight===n.height||(t.restore&&(a=this.getCanvasData(),o=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(H(a,(function(t,e){a[e]=t*s}))),this.setCropBoxData(H(o,(function(t,e){o[e]=t*s})))))}},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(function(t,e){return t.classList?t.classList.contains(e):t.className.indexOf(e)>-1}(this.dragBox,d)?"move":"crop")},wheel:function(t){var e=this,n=Number(this.options.wheelZoomRatio)||.1,i=1;this.disabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){e.wheeling=!1}),50),t.deltaY?i=t.deltaY>0?1:-1:t.wheelDelta?i=-t.wheelDelta/120:t.detail&&(i=t.detail>0?1:-1),this.zoom(-i*n,t)))},cropStart:function(t){var e=t.buttons,n=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(B(e)&&1!==e||B(n)&&0!==n||t.ctrlKey))){var i,r=this.options,a=this.pointers;t.changedTouches?H(t.changedTouches,(function(t){a[t.identifier]=dt(t)})):a[t.pointerId||0]=dt(t),i=Object.keys(a).length>1&&r.zoomable&&r.zoomOnTouch?"zoom":G(t.target,y),k.test(i)&&!1!==rt(this.element,"cropstart",{originalEvent:t,action:i})&&(t.preventDefault(),this.action=i,this.cropping=!1,"crop"===i&&(this.cropping=!0,Y(this.dragBox,g)))}},cropMove:function(t){var e=this.action;if(!this.disabled&&e){var n=this.pointers;t.preventDefault(),!1!==rt(this.element,"cropmove",{originalEvent:t,action:e})&&(t.changedTouches?H(t.changedTouches,(function(t){P(n[t.identifier]||{},dt(t,!0))})):P(n[t.pointerId||0]||{},dt(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,n=this.pointers;t.changedTouches?H(t.changedTouches,(function(t){delete n[t.identifier]})):delete n[t.pointerId||0],e&&(t.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,V(this.dragBox,g,this.cropped&&this.options.modal)),rt(this.element,"cropend",{originalEvent:t,action:e}))}}},xt={change:function(t){var e,n=this.options,i=this.canvasData,r=this.containerData,o=this.cropBoxData,s=this.pointers,l=this.action,c=n.aspectRatio,u=o.left,d=o.top,h=o.width,f=o.height,m=u+h,g=d+f,v=0,y=0,b=r.width,w=r.height,x=!0;!c&&t.shiftKey&&(c=h&&f?h/f:1),this.limited&&(v=o.minLeft,y=o.minTop,b=v+Math.min(r.width,i.width,i.left+i.width),w=y+Math.min(r.height,i.height,i.top+i.height));var C=s[Object.keys(s)[0]],E={x:C.endX-C.startX,y:C.endY-C.startY},_=function(t){switch(t){case"e":m+E.x>b&&(E.x=b-m);break;case"w":u+E.x<v&&(E.x=v-u);break;case"n":d+E.y<y&&(E.y=y-d);break;case"s":g+E.y>w&&(E.y=w-g)}};switch(l){case"all":u+=E.x,d+=E.y;break;case"e":if(E.x>=0&&(m>=b||c&&(d<=y||g>=w))){x=!1;break}_("e"),(h+=E.x)<0&&(l="w",u-=h=-h),c&&(f=h/c,d+=(o.height-f)/2);break;case"n":if(E.y<=0&&(d<=y||c&&(u<=v||m>=b))){x=!1;break}_("n"),f-=E.y,d+=E.y,f<0&&(l="s",d-=f=-f),c&&(h=f*c,u+=(o.width-h)/2);break;case"w":if(E.x<=0&&(u<=v||c&&(d<=y||g>=w))){x=!1;break}_("w"),h-=E.x,u+=E.x,h<0&&(l="e",u-=h=-h),c&&(f=h/c,d+=(o.height-f)/2);break;case"s":if(E.y>=0&&(g>=w||c&&(u<=v||m>=b))){x=!1;break}_("s"),(f+=E.y)<0&&(l="n",d-=f=-f),c&&(h=f*c,u+=(o.width-h)/2);break;case"ne":if(c){if(E.y<=0&&(d<=y||m>=b)){x=!1;break}_("n"),f-=E.y,d+=E.y,h=f*c}else _("n"),_("e"),E.x>=0?m<b?h+=E.x:E.y<=0&&d<=y&&(x=!1):h+=E.x,E.y<=0?d>y&&(f-=E.y,d+=E.y):(f-=E.y,d+=E.y);h<0&&f<0?(l="sw",d-=f=-f,u-=h=-h):h<0?(l="nw",u-=h=-h):f<0&&(l="se",d-=f=-f);break;case"nw":if(c){if(E.y<=0&&(d<=y||u<=v)){x=!1;break}_("n"),f-=E.y,d+=E.y,h=f*c,u+=o.width-h}else _("n"),_("w"),E.x<=0?u>v?(h-=E.x,u+=E.x):E.y<=0&&d<=y&&(x=!1):(h-=E.x,u+=E.x),E.y<=0?d>y&&(f-=E.y,d+=E.y):(f-=E.y,d+=E.y);h<0&&f<0?(l="se",d-=f=-f,u-=h=-h):h<0?(l="ne",u-=h=-h):f<0&&(l="sw",d-=f=-f);break;case"sw":if(c){if(E.x<=0&&(u<=v||g>=w)){x=!1;break}_("w"),h-=E.x,u+=E.x,f=h/c}else _("s"),_("w"),E.x<=0?u>v?(h-=E.x,u+=E.x):E.y>=0&&g>=w&&(x=!1):(h-=E.x,u+=E.x),E.y>=0?g<w&&(f+=E.y):f+=E.y;h<0&&f<0?(l="ne",d-=f=-f,u-=h=-h):h<0?(l="se",u-=h=-h):f<0&&(l="nw",d-=f=-f);break;case"se":if(c){if(E.x>=0&&(m>=b||g>=w)){x=!1;break}_("e"),f=(h+=E.x)/c}else _("s"),_("e"),E.x>=0?m<b?h+=E.x:E.y>=0&&g>=w&&(x=!1):h+=E.x,E.y>=0?g<w&&(f+=E.y):f+=E.y;h<0&&f<0?(l="nw",d-=f=-f,u-=h=-h):h<0?(l="sw",u-=h=-h):f<0&&(l="ne",d-=f=-f);break;case"move":this.move(E.x,E.y),x=!1;break;case"zoom":this.zoom(function(t){var e=a({},t),n=[];return H(t,(function(t,i){delete e[i],H(e,(function(e){var i=Math.abs(t.startX-e.startX),r=Math.abs(t.startY-e.startY),a=Math.abs(t.endX-e.endX),o=Math.abs(t.endY-e.endY),s=Math.sqrt(i*i+r*r),l=(Math.sqrt(a*a+o*o)-s)/s;n.push(l)}))})),n.sort((function(t,e){return Math.abs(t)<Math.abs(e)})),n[0]}(s),t),x=!1;break;case"crop":if(!E.x||!E.y){x=!1;break}e=at(this.cropper),u=C.startX-e.left,d=C.startY-e.top,h=o.minWidth,f=o.minHeight,E.x>0?l=E.y>0?"se":"ne":E.x<0&&(u-=h,l=E.y>0?"sw":"nw"),E.y<0&&(d-=f),this.cropped||(K(this.cropBox,p),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}x&&(o.width=h,o.height=f,o.left=u,o.top=d,this.action=l,this.renderCropBox()),H(s,(function(t){t.startX=t.endX,t.startY=t.endY}))}},Ct={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Y(this.dragBox,g),K(this.cropBox,p),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=P({},this.initialImageData),this.canvasData=P({},this.initialCanvasData),this.cropBoxData=P({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(P(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),K(this.dragBox,g),Y(this.cropBox,p)),this},replace:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,H(this.previews,(function(e){e.getElementsByTagName("img")[0].src=t})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,K(this.cropper,h)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Y(this.cropper,h)),this},destroy:function(){var t=this.element;return t.cropper?(t.cropper=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.canvasData,i=n.left,r=n.top;return this.moveTo(z(t)?t:i+Number(t),z(e)?e:r+Number(e))},moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.canvasData,i=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(B(t)&&(n.left=t,i=!0),B(e)&&(n.top=e,i=!0),i&&this.renderCanvas(!0)),this},zoom:function(t,e){var n=this.canvasData;return t=(t=Number(t))<0?1/(1-t):1+t,this.zoomTo(n.width*t/n.naturalWidth,null,e)},zoomTo:function(t,e,n){var i=this.options,r=this.canvasData,a=r.width,o=r.height,s=r.naturalWidth,l=r.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&i.zoomable){var c=s*t,u=l*t;if(!1===rt(this.element,"zoom",{ratio:t,oldRatio:a/s,originalEvent:n}))return this;if(n){var d=this.pointers,h=at(this.cropper),p=d&&Object.keys(d).length?function(t){var e=0,n=0,i=0;return H(t,(function(t){var r=t.startX,a=t.startY;e+=r,n+=a,i+=1})),{pageX:e/=i,pageY:n/=i}}(d):{pageX:n.pageX,pageY:n.pageY};r.left-=(c-a)*((p.pageX-h.left-r.left)/a),r.top-=(u-o)*((p.pageY-h.top-r.top)/o)}else F(e)&&B(e.x)&&B(e.y)?(r.left-=(c-a)*((e.x-r.left)/a),r.top-=(u-o)*((e.y-r.top)/o)):(r.left-=(c-a)/2,r.top-=(u-o)/2);r.width=c,r.height=u,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return B(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,B(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(B(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=this.imageData,i=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(B(t)&&(n.scaleX=t,i=!0),B(e)&&(n.scaleY=e,i=!0),i&&this.renderCanvas(!0,!0)),this},getData:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.options,i=this.imageData,r=this.canvasData,a=this.cropBoxData;if(this.ready&&this.cropped){t={x:a.left-r.left,y:a.top-r.top,width:a.width,height:a.height};var o=i.width/i.naturalWidth;if(H(t,(function(e,n){t[n]=e/o})),e){var s=Math.round(t.y+t.height),l=Math.round(t.x+t.width);t.x=Math.round(t.x),t.y=Math.round(t.y),t.width=l-t.x,t.height=s-t.y}}else t={x:0,y:0,width:0,height:0};return n.rotatable&&(t.rotate=i.rotate||0),n.scalable&&(t.scaleX=i.scaleX||1,t.scaleY=i.scaleY||1),t},setData:function(t){var e=this.options,n=this.imageData,i=this.canvasData,r={};if(this.ready&&!this.disabled&&F(t)){var a=!1;e.rotatable&&B(t.rotate)&&t.rotate!==n.rotate&&(n.rotate=t.rotate,a=!0),e.scalable&&(B(t.scaleX)&&t.scaleX!==n.scaleX&&(n.scaleX=t.scaleX,a=!0),B(t.scaleY)&&t.scaleY!==n.scaleY&&(n.scaleY=t.scaleY,a=!0)),a&&this.renderCanvas(!0,!0);var o=n.width/n.naturalWidth;B(t.x)&&(r.left=t.x*o+i.left),B(t.y)&&(r.top=t.y*o+i.top),B(t.width)&&(r.width=t.width*o),B(t.height)&&(r.height=t.height*o),this.setCropBoxData(r)}return this},getContainerData:function(){return this.ready?P({},this.containerData):{}},getImageData:function(){return this.sized?P({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&H(["left","top","width","height","naturalWidth","naturalHeight"],(function(n){e[n]=t[n]})),e},setCanvasData:function(t){var e=this.canvasData,n=e.aspectRatio;return this.ready&&!this.disabled&&F(t)&&(B(t.left)&&(e.left=t.left),B(t.top)&&(e.top=t.top),B(t.width)?(e.width=t.width,e.height=t.width/n):B(t.height)&&(e.height=t.height,e.width=t.height*n),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,e=this.cropBoxData;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,n,i=this.cropBoxData,r=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&F(t)&&(B(t.left)&&(i.left=t.left),B(t.top)&&(i.top=t.top),B(t.width)&&t.width!==i.width&&(e=!0,i.width=t.width),B(t.height)&&t.height!==i.height&&(n=!0,i.height=t.height),r&&(e?i.height=i.width/r:n&&(i.width=i.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,n=pt(this.image,this.imageData,e,t);if(!this.cropped)return n;var i=this.getData(),r=i.x,a=i.y,s=i.width,l=i.height,c=n.width/Math.floor(e.naturalWidth);1!==c&&(r*=c,a*=c,s*=c,l*=c);var u=s/l,d=ht({aspectRatio:u,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),h=ht({aspectRatio:u,width:t.minWidth||0,height:t.minHeight||0},"cover"),p=ht({aspectRatio:u,width:t.width||(1!==c?n.width:s),height:t.height||(1!==c?n.height:l)}),f=p.width,m=p.height;f=Math.min(d.width,Math.max(h.width,f)),m=Math.min(d.height,Math.max(h.height,m));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=U(f),g.height=U(m),v.fillStyle=t.fillColor||"transparent",v.fillRect(0,0,f,m);var y=t.imageSmoothingEnabled,b=void 0===y||y,w=t.imageSmoothingQuality;v.imageSmoothingEnabled=b,w&&(v.imageSmoothingQuality=w);var x,C,E,_,M,k,O=n.width,D=n.height,T=r,S=a;T<=-s||T>O?(T=0,x=0,E=0,M=0):T<=0?(E=-T,T=0,M=x=Math.min(O,s+T)):T<=O&&(E=0,M=x=Math.min(s,O-T)),x<=0||S<=-l||S>D?(S=0,C=0,_=0,k=0):S<=0?(_=-S,S=0,k=C=Math.min(D,l+S)):S<=D&&(_=0,k=C=Math.min(l,D-S));var L=[T,S,x,C];if(M>0&&k>0){var B=f/s;L.push(E*B,_*B,M*B,k*B)}return v.drawImage.apply(v,[n].concat(o(L.map((function(t){return Math.floor(U(t))}))))),g},setAspectRatio:function(t){var e=this.options;return this.disabled||z(t)||(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,n=this.dragBox,i=this.face;if(this.ready&&!this.disabled){var r="crop"===t,a=e.movable&&"move"===t;t=r||a?t:"none",e.dragMode=t,J(n,y,t),V(n,d,r),V(n,v,a),e.cropBoxMovable||(J(i,y,t),V(i,d,r),V(i,v,a))}return this}},Et=l.Cropper,_t=function(){function t(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e(this,t),!n||!T.test(n.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=n,this.options=P({},S,F(i)&&i),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var i,r,a;return i=t,a=[{key:"noConflict",value:function(){return window.Cropper=Et,t}},{key:"setDefaults",value:function(t){P(S,F(t)&&t)}}],(r=[{key:"init",value:function(){var t,e=this.element,n=e.tagName.toLowerCase();if(!e.cropper){if(e.cropper=this,"img"===n){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===n&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}},{key:"load",value:function(t){var e=this;if(t){this.url=t,this.imageData={};var n=this.element,i=this.options;if(i.rotatable||i.scalable||(i.checkOrientation=!1),i.checkOrientation&&window.ArrayBuffer)if(O.test(t))D.test(t)?this.read((r=t.replace(mt,""),a=atob(r),o=new ArrayBuffer(a.length),H(s=new Uint8Array(o),(function(t,e){s[e]=a.charCodeAt(e)})),o)):this.clone();else{var r,a,o,s,l=new XMLHttpRequest,c=this.clone.bind(this);this.reloading=!0,this.xhr=l,l.onabort=c,l.onerror=c,l.ontimeout=c,l.onprogress=function(){"image/jpeg"!==l.getResponseHeader("content-type")&&l.abort()},l.onload=function(){e.read(l.response)},l.onloadend=function(){e.reloading=!1,e.xhr=null},i.checkCrossOrigin&&lt(t)&&n.crossOrigin&&(t=ct(t)),l.open("GET",t),l.responseType="arraybuffer",l.withCredentials="use-credentials"===n.crossOrigin,l.send()}else this.clone()}}},{key:"read",value:function(t){var e=this.options,n=this.imageData,i=gt(t),r=0,a=1,o=1;if(i>1){this.url=function(t,e){for(var n=[],i=new Uint8Array(t);i.length>0;)n.push(ft.apply(null,R(i.subarray(0,8192)))),i=i.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(n.join("")))}(t,"image/jpeg");var s=function(t){var e=0,n=1,i=1;switch(t){case 2:n=-1;break;case 3:e=-180;break;case 4:i=-1;break;case 5:e=90,i=-1;break;case 6:e=90;break;case 7:e=90,n=-1;break;case 8:e=-90}return{rotate:e,scaleX:n,scaleY:i}}(i);r=s.rotate,a=s.scaleX,o=s.scaleY}e.rotatable&&(n.rotate=r),e.scalable&&(n.scaleX=a,n.scaleY=o),this.clone()}},{key:"clone",value:function(){var t=this.element,e=this.url,n=t.crossOrigin,i=e;this.options.checkCrossOrigin&&lt(e)&&(n||(n="anonymous"),i=ct(e)),this.crossOrigin=n,this.crossOriginUrl=i;var r=document.createElement("img");n&&(r.crossOrigin=n),r.src=i||e,r.alt=t.alt||"The image to crop",this.image=r,r.onload=this.start.bind(this),r.onerror=this.stop.bind(this),Y(r,f),t.parentNode.insertBefore(r,t.nextSibling)}},{key:"start",value:function(){var t=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var n=l.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(l.navigator.userAgent),i=function(e,n){P(t.imageData,{naturalWidth:e,naturalHeight:n,aspectRatio:e/n}),t.sizing=!1,t.sized=!0,t.build()};if(!e.naturalWidth||n){var r=document.createElement("img"),a=document.body||document.documentElement;this.sizingImage=r,r.onload=function(){i(r.width,r.height),n||a.removeChild(r)},r.src=e.src,n||(r.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",a.appendChild(r))}else i(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var t=this.element,e=this.options,n=this.image,i=t.parentNode,r=document.createElement("div");r.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var a=r.querySelector(".".concat("cropper","-container")),o=a.querySelector(".".concat("cropper","-canvas")),s=a.querySelector(".".concat("cropper","-drag-box")),l=a.querySelector(".".concat("cropper","-crop-box")),c=l.querySelector(".".concat("cropper","-face"));this.container=i,this.cropper=a,this.canvas=o,this.dragBox=s,this.cropBox=l,this.viewBox=a.querySelector(".".concat("cropper","-view-box")),this.face=c,o.appendChild(n),Y(t,p),i.insertBefore(a,t.nextSibling),this.isImg||K(n,f),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,Y(l,p),e.guides||Y(l.getElementsByClassName("".concat("cropper","-dashed")),p),e.center||Y(l.getElementsByClassName("".concat("cropper","-center")),p),e.background&&Y(a,"".concat("cropper","-bg")),e.highlight||Y(c,m),e.cropBoxMovable&&(Y(c,v),J(c,y,"all")),e.cropBoxResizable||(Y(l.getElementsByClassName("".concat("cropper","-line")),p),Y(l.getElementsByClassName("".concat("cropper","-point")),p)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),N(e.ready)&&it(t,"ready",e.ready,{once:!0}),rt(t,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),K(this.element,p))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&n(i.prototype,r),a&&n(i,a),t}();return P(_t.prototype,vt,yt,bt,wt,xt,Ct),_t}()}));function he(t,e,n){const i=t.slice();return i[28]=e[n],i}function pe(t,e,n){const i=t.slice();return i[31]=e[n],i}function fe(t){let e,n,i;const r=new ue({props:{open:t[1],options:{dragHandle:".header"},$$slots:{default:[_e]},$$scope:{ctx:t}}});return{c(){e=b("div"),ot(r.$$.fragment),M(e,"class","overlay svelte-1ap2r11")},m(t,n){g(t,e,n),st(r,e,null),i=!0},p(t,e){const n={};2&e[0]&&(n.open=t[1]),1021&e[0]|8&e[1]&&(n.$$scope={dirty:e,ctx:t}),r.$set(n)},i(t){i||(tt(r.$$.fragment,t),A(()=>{n||(n=it(e,ie,{},!0)),n.run(1)}),i=!0)},o(t){et(r.$$.fragment,t),n||(n=it(e,ie,{},!1)),n.run(0),i=!1},d(t){t&&v(e),lt(r),t&&n&&n.end()}}}function me(t){let e,n,i,r,a,o,s=t[31]+"";return{c(){e=b("div"),n=b("span"),i=x(),r=b("span"),r.innerHTML='<i class="btn-close-error far fa-window-close svelte-1ap2r11"></i>',a=x(),M(r,"class","btn-close-error svelte-1ap2r11"),M(e,"class","file-editor-error svelte-1ap2r11")},m(t,l,c){g(t,e,l),m(e,n),n.innerHTML=s,m(e,i),m(e,r),m(e,a),c&&o(),o=E(r,"click",ke)},p(t,e){1&e[0]&&s!==(s=t[31]+"")&&(n.innerHTML=s)},d(t){t&&v(e),o()}}}function ge(e){let n;return{c(){n=b("span"),n.textContent=""+e[10].directory,M(n,"class","element-dirname svelte-1ap2r11")},m(t,e){g(t,n,e)},p:t,d(t){t&&v(n)}}}function ve(t){let e,n,i;return{c(){e=b("input"),M(e,"id",n="id-fileuploader-dirname-"+t[11]),M(e,"type","text"),M(e,"name","dirname"),e.value=i=t[2].directory,M(e,"class","input-dirname svelte-1ap2r11")},m(t,n){g(t,e,n)},p(t,n){4&n[0]&&i!==(i=t[2].directory)&&e.value!==i&&(e.value=i)},d(t){t&&v(e)}}}function ye(t){let e,n,i,r=t[28]+"";return{c(){e=b("option"),n=w(r),e.__value=i=t[28],e.value=e.__value,e.selected="selected"},m(t,i){g(t,e,i),m(e,n)},p(t,a){4&a[0]&&r!==(r=t[28]+"")&&k(n,r),4&a[0]&&i!==(i=t[28])&&(e.__value=i),e.value=e.__value},d(t){t&&v(e)}}}function be(t){let e,n,i,r,a,o,s=!0===t[10].useKeepOriginalImage&&null!==t[2].original_url&&we(t);function l(t,e){return!0===t[2].is_loading||!0===t[9]?Ce:xe}let c=l(t),u=c(t);return{c(){e=b("div"),n=b("div"),i=b("label"),i.textContent="Image Editor",r=x(),s&&s.c(),a=x(),o=b("div"),u.c(),M(i,"class","svelte-1ap2r11"),M(n,"class","image-editor-header svelte-1ap2r11"),M(o,"class","image-editor-body svelte-1ap2r11"),M(e,"class","control-group image-editor-container svelte-1ap2r11")},m(t,l){g(t,e,l),m(e,n),m(n,i),m(n,r),s&&s.m(n,null),m(e,a),m(e,o),u.m(o,null)},p(t,e){!0===t[10].useKeepOriginalImage&&null!==t[2].original_url?s?s.p(t,e):(s=we(t),s.c(),s.m(n,null)):s&&(s.d(1),s=null),c!==(c=l(t))&&(u.d(1),u=c(t),u&&(u.c(),u.m(o,null)))},d(t){t&&v(e),s&&s.d(),u.d()}}}function we(t){let e,n,i,r,a,o,s,l;return{c(){e=b("div"),n=b("label"),i=w("Use original\n                                                    image"),a=x(),o=b("input"),M(n,"for",r="id-fileuploader-original-toggle-"+t[11]),M(n,"class","svelte-1ap2r11"),M(o,"id",s="id-fileuploader-original-toggle-"+t[11]),M(o,"type","checkbox"),o.value="1",o.checked=t[4],M(o,"class","input-original-toggle"),M(e,"class","control-original-toggle svelte-1ap2r11")},m(r,s,c){g(r,e,s),m(e,n),m(n,i),m(e,a),m(e,o),c&&l(),l=E(o,"change",t[14])},p(t,e){16&e[0]&&(o.checked=t[4])},d(t){t&&v(e),l()}}}function xe(t){let e,n,i;return{c(){e=b("div"),e.innerHTML='<div class="img-container svelte-1ap2r11"><img class="image-original svelte-1ap2r11" src="" alt="Canvas for the cropper editor"></div> \n\n\n                                                <div class="image-editor-toolbar svelte-1ap2r11"><div class="btn-group"><button type="button" class="btn btn-primary svelte-1ap2r11" data-method="zoom" data-option="0.1" title="Zoom In"><span class="fa fa-search-plus"></span></button> \n                                                        <button type="button" class="btn btn-primary svelte-1ap2r11" data-method="zoom" data-option="-0.1" title="Zoom Out"><span class="fa fa-search-minus"></span></button></div> \n\n                                                    <div class="btn-group"><button type="button" class="btn btn-primary svelte-1ap2r11" data-method="rotate" data-option="-45" title="Rotate Left"><span class="fa fa-undo-alt"></span></button> \n\n                                                        <button type="button" class="btn btn-primary svelte-1ap2r11" data-method="rotate" data-option="45" title="Rotate Right"><span class="fa fa-redo-alt"></span></button></div> \n\n                                                    <div class="btn-group"><button type="button" class="btn btn-primary svelte-1ap2r11" data-method="scaleX" data-option="-1" title="Flip Horizontal"><span class="fa fa-arrows-alt-h"></span></button> \n\n                                                        <button type="button" class="btn btn-primary svelte-1ap2r11" data-method="scaleY" data-option="-1" title="Flip Vertical"><span class="fa fa-arrows-alt-v"></span></button></div> \n\n                                                    <div class="btn-group"><button type="button" class="btn btn-primary svelte-1ap2r11" data-method="reset" title="Reset"><span class="fa fa-sync-alt"></span></button></div></div>',n=x(),i=b("div"),i.innerHTML='<div class="img-preview preview-lg svelte-1ap2r11"></div>',M(e,"class","left svelte-1ap2r11"),M(i,"class","img-preview-container svelte-1ap2r11")},m(t,r){g(t,e,r),g(t,n,r),g(t,i,r)},d(t){t&&v(e),t&&v(n),t&&v(i)}}}function Ce(t){let e;return{c(){e=b("div"),e.innerHTML='<div class="img-container is-loading svelte-1ap2r11"><div class="spinner svelte-1ap2r11"><i class="fas fa-cog fa-spin fa-5x svelte-1ap2r11"></i></div></div>',M(e,"class","left svelte-1ap2r11")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function Ee(t){let e;return{c(){e=b("div"),e.innerHTML='<i class="fas fa-circle-notch fa-spin fa-2x svelte-1ap2r11"></i>',M(e,"class","spinner svelte-1ap2r11")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function _e(t){let e,n,i,a,o,s,l,u,d,h,p,f,T,S,L,B,$,z,j,q,F,N,I,R,H,P,A,U,W,X,Y,K,V,Q,Z,G,J,tt,et,nt,it,rt,at,ot,st,lt,ct,ut,dt,ht,ft,mt=t[2].progress+"",gt=t[0],vt=[];for(let e=0;e<gt.length;e+=1)vt[e]=me(pe(t,gt,e));let yt=!0===t[10].useDirectory&&function(t){let e,n,i,r,a,o=function(t,e){return!0===t[10].directoryCanBeUpdated?ve:ge}(t)(t);return{c(){e=b("label"),n=w("Parent dir:"),r=x(),o.c(),a=C(),M(e,"for",i="id-fileuploader-dirname-"+t[11]),M(e,"class","svelte-1ap2r11")},m(t,i){g(t,e,i),m(e,n),g(t,r,i),o.m(t,i),g(t,a,i)},p(t,e){o.p(t,e)},d(t){t&&v(e),t&&v(r),o.d(t),t&&v(a)}}}(t),bt=!0===t[10].usePrivacy&&function(t){let e,n,i,r,a,o,s,l;return{c(){e=b("div"),n=b("label"),i=w("Is private"),a=x(),o=b("input"),M(n,"for",r="id-fileuploader-privacy-"+t[11]),M(n,"class","svelte-1ap2r11"),M(o,"id",s="id-fileuploader-privacy-"+t[11]),M(o,"type","checkbox"),M(o,"name","is_private"),o.value="1",M(o,"class","input-privacy"),o.checked=l=pt.toBool(t[2].is_private),M(e,"class","control-group control-privacy svelte-1ap2r11")},m(t,r){g(t,e,r),m(e,n),m(n,i),m(e,a),m(e,o)},p(t,e){4&e[0]&&l!==(l=pt.toBool(t[2].is_private))&&(o.checked=l)},d(t){t&&v(e)}}}(t),wt=!0===t[10].useTags&&function(t){let e,n,i,r,a,o,s,l=t[2].tags,c=[];for(let e=0;e<l.length;e+=1)c[e]=ye(he(t,l,e));return{c(){e=b("div"),n=b("label"),i=w("Tags"),a=x(),o=b("select");for(let t=0;t<c.length;t+=1)c[t].c();M(n,"for",r="id-fileuploader-tags-"+t[11]),M(n,"class","svelte-1ap2r11"),M(o,"class","select-tags svelte-1ap2r11"),M(o,"id",s="id-fileuploader-tags-"+t[11]),M(o,"name","tags[]"),o.multiple=!0,M(e,"class","control-group control-tags svelte-1ap2r11")},m(t,r){g(t,e,r),m(e,n),m(n,i),m(e,a),m(e,o);for(let t=0;t<c.length;t+=1)c[t].m(o,null)},p(t,e){if(4&e[0]){let n;for(l=t[2].tags,n=0;n<l.length;n+=1){const i=he(t,l,n);c[n]?c[n].p(i,e):(c[n]=ye(i),c[n].c(),c[n].m(o,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=l.length}},d(t){t&&v(e),y(c,t)}}}(t),xt=!0===t[10].useImageEditor&&!0===t[8]&&be(t),Ct=!0===t[2].is_loading&&!1==(!0===t[10].useImageEditor&&!0===t[8])&&Ee();return{c(){e=b("div"),n=b("div"),i=w(t[5]),a=x(),o=b("div"),s=b("span"),l=w(t[3]),u=x(),d=b("span"),h=x(),p=b("div"),f=b("div"),T=b("div");for(let t=0;t<vt.length;t+=1)vt[t].c();S=x(),L=b("form"),B=b("div"),$=b("div"),yt&&yt.c(),z=x(),bt&&bt.c(),j=x(),q=b("div"),F=b("label"),N=w("File name"),R=x(),H=b("div"),P=b("input"),W=x(),X=b("input"),V=x(),wt&&wt.c(),Q=x(),xt&&xt.c(),Z=x(),G=b("div"),Ct&&Ct.c(),J=x(),tt=b("div"),et=w("Uploading... "),nt=w(mt),it=w("%"),rt=x(),at=b("button"),ot=w("Cancel"),lt=x(),ct=b("button"),ut=w("Update"),O(n,"display","none"),M(s,"class","title"),M(d,"class","close-modal-btn far fa-times-circle svelte-1ap2r11"),M(o,"class","header svelte-1ap2r11"),M(T,"class","file-editor-error-container"),M($,"class","control-group control-dirname svelte-1ap2r11"),M(B,"class","file-editor-block-1 svelte-1ap2r11"),M(F,"for",I="id-fileuploader-filename-"+t[11]),M(F,"class","svelte-1ap2r11"),M(P,"id",A="id-fileuploader-filename-"+t[11]),M(P,"type","text"),M(P,"name","basename"),P.value=U=pt.basename(t[2].name,!1),M(P,"class","input-basename svelte-1ap2r11"),M(X,"type","text"),M(X,"name","extension"),X.value=Y=pt.getFileExtension(t[2].name),M(X,"class","input-extension svelte-1ap2r11"),X.disabled=K=!1===t[10].fileExtensionCanBeUpdated,M(H,"class","filename-inputs-container svelte-1ap2r11"),M(q,"class","control-group control-filename svelte-1ap2r11"),M(L,"action",""),M(L,"method","post"),M(tt,"class","progress-bar svelte-1ap2r11"),D(tt,"show",t[2].progress>0&&t[2].progress<100),M(at,"class",st=c(t[6])+" svelte-1ap2r11"),M(ct,"class",dt=c(t[7])+" svelte-1ap2r11"),M(G,"class","buttons-bar svelte-1ap2r11"),M(f,"title","File Editor"),M(f,"class","dialog-file-editor"),M(p,"class","body file-editor"),M(e,"class","container file-editor-container svelte-1ap2r11"),M(e,"id",ht="file-editor-dialog-"+t[11])},m(c,v,y){g(c,e,v),m(e,n),m(n,i),m(e,a),m(e,o),m(o,s),m(s,l),m(o,u),m(o,d),m(e,h),m(e,p),m(p,f),m(f,T);for(let t=0;t<vt.length;t+=1)vt[t].m(T,null);m(f,S),m(f,L),m(L,B),m(B,$),yt&&yt.m($,null),m(B,z),bt&&bt.m(B,null),m(L,j),m(L,q),m(q,F),m(F,N),m(q,R),m(q,H),m(H,P),m(H,W),m(H,X),m(L,V),wt&&wt.m(L,null),m(L,Q),xt&&xt.m(L,null),m(f,Z),m(f,G),Ct&&Ct.m(G,null),m(G,J),m(G,tt),m(tt,et),m(tt,nt),m(tt,it),m(G,rt),m(G,at),m(at,ot),m(G,lt),m(G,ct),m(ct,ut),y&&r(ft),ft=[E(d,"click",t[13]),E(at,"click",_(t[13])),E(ct,"click",_(t[12]))]},p(t,e){if(32&e[0]&&k(i,t[5]),8&e[0]&&k(l,t[3]),1&e[0]){let n;for(gt=t[0],n=0;n<gt.length;n+=1){const i=pe(t,gt,n);vt[n]?vt[n].p(i,e):(vt[n]=me(i),vt[n].c(),vt[n].m(T,null))}for(;n<vt.length;n+=1)vt[n].d(1);vt.length=gt.length}!0===t[10].useDirectory&&yt.p(t,e),!0===t[10].usePrivacy&&bt.p(t,e),4&e[0]&&U!==(U=pt.basename(t[2].name,!1))&&P.value!==U&&(P.value=U),4&e[0]&&Y!==(Y=pt.getFileExtension(t[2].name))&&X.value!==Y&&(X.value=Y),!0===t[10].useTags&&wt.p(t,e),!0===t[10].useImageEditor&&!0===t[8]?xt?xt.p(t,e):(xt=be(t),xt.c(),xt.m(L,null)):xt&&(xt.d(1),xt=null),!0===t[2].is_loading&&!1==(!0===t[10].useImageEditor&&!0===t[8])?Ct||(Ct=Ee(),Ct.c(),Ct.m(G,J)):Ct&&(Ct.d(1),Ct=null),4&e[0]&&mt!==(mt=t[2].progress+"")&&k(nt,mt),4&e[0]&&D(tt,"show",t[2].progress>0&&t[2].progress<100),64&e[0]&&st!==(st=c(t[6])+" svelte-1ap2r11")&&M(at,"class",st),128&e[0]&&dt!==(dt=c(t[7])+" svelte-1ap2r11")&&M(ct,"class",dt)},d(t){t&&v(e),y(vt,t),yt&&yt.d(),bt&&bt.d(),wt&&wt.d(),xt&&xt.d(),Ct&&Ct.d(),r(ft)}}}function Me(t){let e,n,i=null!==t[2]&&!0===t[1]&&fe(t);return{c(){i&&i.c(),e=C()},m(t,r){i&&i.m(t,r),g(t,e,r),n=!0},p(t,n){null!==t[2]&&!0===t[1]?i?(i.p(t,n),6&n[0]&&tt(i,1)):(i=fe(t),i.c(),tt(i,1),i.m(e.parentNode,e)):i&&(G(),et(i,1,1,()=>{i=null}),J())},i(t){n||(tt(i),n=!0)},o(t){et(i),n=!1},d(t){i&&i.d(t),t&&v(e)}}}function ke(t){t.target.closest(".file-editor-error").remove()}function Oe(t,e,n){let{isOpen:i=!1}=e,{uFile:r={}}=e,{title:a="FileEditor"}=e,{errors:o=[]}=e,s=!1,l=0;const{onCloseFileEditorBtnClicked:c,onFileEditorFileDropped:u,onFileEditorUpdated:d,fileEditorOptions:h}=(p="fileUploader",q().$$.context.get(p));var p;const f=h;let m="btn-cancel",g="btn-update";!0===f.useBootstrap&&(m="btn btn-danger mr-2",g="btn btn-success");let v,y,b=pt.cssId(),w=!1,x=null,C=null,E=!1,_=null,M=null;var k;function O(){null!==_&&_.destroy(),_=null}function D(){C=null,c()}function T(t){n(0,o=[...o,t])}return k=()=>{if(!0===i){if(v=jQuery("#file-editor-dialog-"+b),!0===f.useTags){y=jQuery("#id-fileuploader-tags-"+b);let t={};f.availableTags.length>0&&(t.data=function(t){var e=[];for(var n in t){var i=t[n];e.push({id:i,text:i})}return e}(f.availableTags)),!0===f.allowCustomTags&&(t.tags=!0),t.maximumSelectionLength=f.nbTagsAllowed,y.select2(t)}n(8,w=pt.mimeIsImage(r.type)),!1===E&&(!0===w?setTimeout(()=>{let t=v.find(".image-original");if(t.length){let e,n=t[0];e=!0===s&&null!==C?URL.createObjectURL(C):URL.createObjectURL(r.file),n.src=e;let i={preview:".img-preview",viewMode:1,autoCropArea:1,ready(){x=_.getData()}};_=new de(n,i),v.find(".image-editor-toolbar").off("click").on("click","[data-method]",(function(){var t,e,n=jQuery(this),i=n.data();if(!n.prop("disabled")&&!n.hasClass("disabled")&&_&&i.method){if(void 0!==(i=jQuery.extend({},i)).target&&(e=jQuery(i.target),void 0===i.option))try{i.option=JSON.parse(e.val())}catch(t){console.log(t.message)}switch(t=_.cropped,i.method){case"rotate":t&&_.clear()}switch(_[i.method](i.option,i.secondOption),i.method){case"rotate":t&&_.crop();break;case"scaleX":case"scaleY":jQuery(this).data("option",-i.option)}}}))}},1):O()),null===M&&(M=new wt({container:v[0],cssClass:f.dropzoneOverClass||"dropzone-hover",onDrop:t=>{n(4,s=!1),C=null,u(r,t[0])}}),M.start())}else O(),M=null},q().$$.after_update.push(k),t.$set=t=>{"isOpen"in t&&n(1,i=t.isOpen),"uFile"in t&&n(2,r=t.uFile),"title"in t&&n(3,a=t.title),"errors"in t&&n(0,o=t.errors)},[o,i,r,a,s,l,m,g,w,E,f,b,async function(){let t=!1;null!==_&&(t=!1===pt.compareObjects(x,_.getData())),await d(r,await async function(){let t,e={};!0===f.useDirectory&&(t=!0===f.directoryCanBeUpdated?v.find(".input-dirname").val():f.directory,e.directory=t);if(e.name=v.find(".input-basename").val()+"."+v.find(".input-extension").val(),!0===f.usePrivacy){let t=pt.toInt(v.find(".input-privacy").prop("checked"));e.is_private=t}if(!0===f.useTags){let t=v.find(".select-tags").val();e.tags=t}let n=r.file;null!==_&&(n=await async function(t){return new Promise((e,n)=>{t.getCroppedCanvas().toBlob(t=>{e(t)})})}(_));return e.file=n,e}(),{cropped:t,dropped:!1,original:s}),0===o.length&&(D(),n(4,s=!1))},D,async function(t){if(O(),!0===t.target.checked){if(n(4,s=!0),null!==r.original_url)if(null===C){n(9,E=!0);let t=await fetch(r.original_url).catch(t=>{T("Server error: "+t.message)});if(!0===t.ok){let e=await t.blob().catch(t=>{T("Blob error: could not convert the url into a blob ("+r.original_url+")")});setTimeout((function(){C=e,n(9,E=!1)}),1)}else T("Server error: "+t.statusText)}else n(9,E=!1),n(5,l++,l)}else n(4,s=!1),n(9,E=!1),n(5,l++,l)}]}class De extends dt{constructor(t){super(),ut(this,t,Oe,Me,o,{isOpen:1,uFile:2,title:3,errors:0},[-1,-1])}}function Te(t,e,n){const i=t.slice();return i[73]=e[n],i}function Se(t,e,n){const i=t.slice();return i[73]=e[n],i}function Le(t,e,n){const i=t.slice();return i[78]=e[n],i}function Be(t,e,n){const i=t.slice();return i[73]=e[n],i}function $e(t,e){let n,i;return{key:t,first:null,c(){n=b("input"),M(n,"type","text"),n.readOnly=!0,M(n,"name",e[1]),n.value=i=e[73].url,M(n,"class","svelte-yfqure"),this.first=n},m(t,e){g(t,n,e)},p(t,e){2&e[0]&&M(n,"name",t[1]),2048&e[0]&&i!==(i=t[73].url)&&n.value!==i&&(n.value=i)},d(t){t&&v(n)}}}function ze(t){let e,n,i,r,a,o,s=t[78]+"";return{c(){e=b("div"),n=b("span"),i=x(),r=b("button"),r.innerHTML='<i class="fas fa-times-circle btn-remove-error svelte-yfqure"></i>',a=x(),M(r,"class","btn-remove-error svelte-yfqure"),M(e,"class","error-item svelte-yfqure")},m(t,l,c){g(t,e,l),m(e,n),n.innerHTML=s,m(e,i),m(e,r),m(e,a),c&&o(),o=E(r,"click",_(en))},p(t,e){131072&e[0]&&s!==(s=t[78]+"")&&(n.innerHTML=s)},d(t){t&&v(e),o()}}}function je(t){let e,n,i,r,a,o,s,l,c,u,d,h,p,f,y=t[73].name+"",C=pt.humanSize(t[73].size)+"",E=!0===t[73].is_loading&&Fe();function _(t,e){return t[73].status<2?Ie:Ne}let O=_(t),D=O(t),T=!0===t[0].useFileEditor&&Re(t),S=!0===t[0].useDelete&&He(t);return{c(){e=b("li"),n=b("div"),i=w(y),r=x(),E&&E.c(),a=x(),o=b("div"),D.c(),s=x(),l=b("div"),c=w(C),u=x(),d=b("div"),T&&T.c(),h=x(),S&&S.c(),p=x(),M(n,"class","cell-name svelte-yfqure"),M(o,"class","cell-status svelte-yfqure"),M(l,"class","cell-size svelte-yfqure"),M(d,"class","cell-action gu-hide svelte-yfqure"),M(e,"class","dropzone-text-item-container fileuploader-item svelte-yfqure"),M(e,"data-id",f=t[73].id)},m(t,f){g(t,e,f),m(e,n),m(n,i),m(n,r),E&&E.m(n,null),m(e,a),m(e,o),D.m(o,null),m(e,s),m(e,l),m(l,c),m(e,u),m(e,d),T&&T.m(d,null),m(d,h),S&&S.m(d,null),m(e,p)},p(t,r){2048&r[0]&&y!==(y=t[73].name+"")&&k(i,y),!0===t[73].is_loading?E||(E=Fe(),E.c(),E.m(n,null)):E&&(E.d(1),E=null),O===(O=_(t))&&D?D.p(t,r):(D.d(1),D=O(t),D&&(D.c(),D.m(o,null))),2048&r[0]&&C!==(C=pt.humanSize(t[73].size)+"")&&k(c,C),!0===t[0].useFileEditor?T?T.p(t,r):(T=Re(t),T.c(),T.m(d,h)):T&&(T.d(1),T=null),!0===t[0].useDelete?S?S.p(t,r):(S=He(t),S.c(),S.m(d,null)):S&&(S.d(1),S=null),2048&r[0]&&f!==(f=t[73].id)&&M(e,"data-id",f)},d(t){t&&v(e),E&&E.d(),D.d(),T&&T.d(),S&&S.d()}}}function qe(t){let e,n,i,r,a,o,s,l,c,u,d,h=t[73].name+"";return{c(){e=b("li"),n=b("div"),i=w(h),r=x(),a=b("div"),a.textContent=""+t[24]._("Loading..."),o=x(),s=b("div"),s.textContent="",l=x(),c=b("div"),c.textContent="",u=x(),M(n,"class","cell-name svelte-yfqure"),M(a,"class","cell-status svelte-yfqure"),M(s,"class","cell-size svelte-yfqure"),M(c,"class","cell-action gu-hide svelte-yfqure"),M(e,"class","dropzone-text-item-container fileuploader-item ui-placeholder svelte-yfqure"),M(e,"data-id",d=t[73].id)},m(t,d){g(t,e,d),m(e,n),m(n,i),m(e,r),m(e,a),m(e,o),m(e,s),m(e,l),m(e,c),m(e,u)},p(t,n){2048&n[0]&&h!==(h=t[73].name+"")&&k(i,h),2048&n[0]&&d!==(d=t[73].id)&&M(e,"data-id",d)},d(t){t&&v(e)}}}function Fe(t){let e;return{c(){e=b("i"),M(e,"class","fas fa-circle-notch fa-spin svelte-yfqure")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function Ne(t){let e,n,i=t[73].progress+"";return{c(){e=w(i),n=w("%")},m(t,i){g(t,e,i),g(t,n,i)},p(t,n){2048&n[0]&&i!==(i=t[73].progress+"")&&k(e,i)},d(t){t&&v(e),t&&v(n)}}}function Ie(e){let n;return{c(){n=w("-")},m(t,e){g(t,n,e)},p:t,d(t){t&&v(n)}}}function Re(t){let e,n;function i(...e){return t[64](t[73],...e)}return{c(){e=b("button"),e.innerHTML='<i class="btn-edit-file fas fa-edit svelte-yfqure"></i>',M(e,"class","btn-edit-file svelte-yfqure")},m(t,r,a){g(t,e,r),a&&n(),n=E(e,"click",_(i))},p(e,n){t=e},d(t){t&&v(e),n()}}}function He(t){let e,n;function i(...e){return t[65](t[73],...e)}return{c(){e=b("button"),e.innerHTML='<i class="fas fa-minus-circle btn-remove-file svelte-yfqure"></i>',M(e,"class","btn-remove-file svelte-yfqure")},m(t,r,a){g(t,e,r),a&&n(),n=E(e,"click",_(i))},p(e,n){t=e},d(t){t&&v(e),n()}}}function Pe(t,e){let n,i;function r(t,e){return 0===t[73].status?qe:je}let a=r(e),o=a(e);return{key:t,first:null,c(){n=C(),o.c(),i=C(),this.first=n},m(t,e){g(t,n,e),o.m(t,e),g(t,i,e)},p(t,e){a===(a=r(t))&&o?o.p(t,e):(o.d(1),o=a(t),o&&(o.c(),o.m(i.parentNode,i)))},d(t){t&&v(n),o.d(t),t&&v(i)}}}function Ae(t){let e,n,i,r,a,o,s,l,c,u,d,h,p,f,y,C,E=t[73].name+"",_=pt.humanSize(t[73].size)+"";function O(t,e){return(null==r||2048&e[0])&&(r=!(!0!==pt.mimeIsImage(t[73].type))),r?Xe:We}let D=O(t,[-1]),T=D(t),S=!0===t[0].useFileEditor&&Ye(t),L=!0===t[0].useDelete&&Ke(t),B=!0===t[73].is_loading&&Ve();return{c(){e=b("div"),n=b("div"),i=b("div"),T.c(),a=x(),o=b("div"),s=w(E),l=x(),c=b("div"),u=w(_),d=x(),h=b("div"),S&&S.c(),p=x(),L&&L.c(),f=x(),B&&B.c(),y=x(),M(i,"class","cell-image svelte-yfqure"),M(o,"class","cell-name svelte-yfqure"),M(c,"class","cell-size svelte-yfqure"),M(n,"class","cell-content"),M(h,"class","cell-action gu-hide svelte-yfqure"),M(e,"class","dropzone-image-item-container fileuploader-item svelte-yfqure"),M(e,"data-id",C=t[73].id)},m(t,r){g(t,e,r),m(e,n),m(n,i),T.m(i,null),m(n,a),m(n,o),m(o,s),m(n,l),m(n,c),m(c,u),m(e,d),m(e,h),S&&S.m(h,null),m(h,p),L&&L.m(h,null),m(e,f),B&&B.m(e,null),m(e,y)},p(t,n){D===(D=O(t,n))&&T?T.p(t,n):(T.d(1),T=D(t),T&&(T.c(),T.m(i,null))),2048&n[0]&&E!==(E=t[73].name+"")&&k(s,E),2048&n[0]&&_!==(_=pt.humanSize(t[73].size)+"")&&k(u,_),!0===t[0].useFileEditor?S?S.p(t,n):(S=Ye(t),S.c(),S.m(h,p)):S&&(S.d(1),S=null),!0===t[0].useDelete?L?L.p(t,n):(L=Ke(t),L.c(),L.m(h,null)):L&&(L.d(1),L=null),!0===t[73].is_loading?B||(B=Ve(),B.c(),B.m(e,y)):B&&(B.d(1),B=null),2048&n[0]&&C!==(C=t[73].id)&&M(e,"data-id",C)},d(t){t&&v(e),T.d(),S&&S.d(),L&&L.d(),B&&B.d()}}}function Ue(t){let e,n,i,r,a,o,s,l,c,u,d,h,p=t[73].name+"";return{c(){e=b("div"),n=b("div"),i=b("div"),i.innerHTML='<span class="cell-image-img"></span>',r=x(),a=b("div"),o=w(p),s=x(),l=b("div"),c=x(),u=b("div"),u.innerHTML='<i class="fas fa-circle-notch fa-spin fa-2x svelte-yfqure"></i>',d=x(),M(i,"class","cell-image svelte-yfqure"),M(a,"class","cell-name svelte-yfqure"),M(l,"class","cell-size svelte-yfqure"),M(n,"class","cell-content"),M(u,"class","image-overlay svelte-yfqure"),M(e,"class","dropzone-image-item-container fileuploader-item svelte-yfqure"),M(e,"data-id",h=t[73].id)},m(t,h){g(t,e,h),m(e,n),m(n,i),m(n,r),m(n,a),m(a,o),m(n,s),m(n,l),m(e,c),m(e,u),m(e,d)},p(t,n){2048&n[0]&&p!==(p=t[73].name+"")&&k(o,p),2048&n[0]&&h!==(h=t[73].id)&&M(e,"data-id",h)},d(t){t&&v(e)}}}function We(e){let n;return{c(){n=b("span"),n.innerHTML='<i class="far fa-file svelte-yfqure"></i>',M(n,"class","cell-image-img")},m(t,e){g(t,n,e)},p:t,d(t){t&&v(n)}}}function Xe(t){let e,n,i;return{c(){e=b("img"),M(e,"class","cell-image-img svelte-yfqure"),e.src!==(n=URL.createObjectURL(t[73].file))&&M(e,"src",n),M(e,"alt",i=t[73].name)},m(t,n){g(t,e,n)},p(t,r){2048&r[0]&&e.src!==(n=URL.createObjectURL(t[73].file))&&M(e,"src",n),2048&r[0]&&i!==(i=t[73].name)&&M(e,"alt",i)},d(t){t&&v(e)}}}function Ye(t){let e,n;function i(...e){return t[67](t[73],...e)}return{c(){e=b("button"),e.innerHTML='<i class="btn-edit-file fas fa-edit svelte-yfqure"></i>',M(e,"class","btn-edit-file svelte-yfqure")},m(t,r,a){g(t,e,r),a&&n(),n=E(e,"click",_(i))},p(e,n){t=e},d(t){t&&v(e),n()}}}function Ke(t){let e,n;function i(...e){return t[68](t[73],...e)}return{c(){e=b("button"),e.innerHTML='<i class="fas fa-minus-circle btn-remove-file svelte-yfqure"></i>',M(e,"class","btn-remove-file svelte-yfqure")},m(t,r,a){g(t,e,r),a&&n(),n=E(e,"click",_(i))},p(e,n){t=e},d(t){t&&v(e),n()}}}function Ve(t){let e;return{c(){e=b("div"),e.innerHTML='<i class="fas fa-circle-notch fa-spin fa-2x svelte-yfqure"></i>',M(e,"class","image-overlay svelte-yfqure")},m(t,n){g(t,e,n)},d(t){t&&v(e)}}}function Qe(t,e){let n,i;function r(t,e){return 0===t[73].status?Ue:Ae}let a=r(e),o=a(e);return{key:t,first:null,c(){n=C(),o.c(),i=C(),this.first=n},m(t,e){g(t,n,e),o.m(t,e),g(t,i,e)},p(t,e){a===(a=r(t))&&o?o.p(t,e):(o.d(1),o=a(t),o&&(o.c(),o.m(i.parentNode,i)))},d(t){t&&v(n),o.d(t),t&&v(i)}}}function Ze(t){let e,n,i,r,a,o,s;return{c(){e=b("button"),n=b("i"),i=x(),r=b("span"),r.textContent=""+t[24]._("Start upload"),M(n,"class","btn-start-upload fas fa-arrow-circle-right svelte-yfqure"),M(r,"class","btn-start-upload"),M(e,"class",a=c(t[8])+" svelte-yfqure"),e.disabled=o=!t[23]},m(a,o,l){g(a,e,o),m(e,n),m(e,i),m(e,r),l&&s(),s=E(e,"click",_(t[30]))},p(t,n){256&n[0]&&a!==(a=c(t[8])+" svelte-yfqure")&&M(e,"class",a),8388608&n[0]&&o!==(o=!t[23])&&(e.disabled=o)},d(t){t&&v(e),s()}}}function Ge(t){let e,n,i,r,a;return{c(){e=b("span"),n=w(t[15]),i=w("%")},m(t,r){g(t,e,r),m(e,n),m(e,i),a=!0},p(t,e){(!a||32768&e[0])&&k(n,t[15])},i(t){a||(A(()=>{r||(r=it(e,ie,{},!0)),r.run(1)}),a=!0)},o(t){r||(r=it(e,ie,{},!1)),r.run(0),a=!1},d(t){t&&v(e),t&&r&&r.end()}}}function Je(t){let e,n,i,r,a;return{c(){e=b("span"),n=w(t[15]),i=w("%")},m(t,r){g(t,e,r),m(e,n),m(e,i),a=!0},p(t,e){(!a||32768&e[0])&&k(n,t[15])},i(t){a||(A(()=>{r||(r=it(e,ie,{},!0)),r.run(1)}),a=!0)},o(t){r||(r=it(e,ie,{},!1)),r.run(0),a=!1},d(t){t&&v(e),t&&r&&r.end()}}}function tn(t){let e,n,i,a,o,s,l,u,d,h,p,f,C,T,S,L,B,$,z,j,q,F,N,I,R,H,P,A,U,W,X,Y,K,V,Q,Z,nt,it,ct,ut,dt,ht,ft,mt,gt,vt,yt,bt,wt,xt,Ct,Et,_t,Mt,kt,Ot,Dt,Tt,St,Lt,Bt,$t,zt,jt,qt,Ft,Nt,It,Rt,Ht,Pt=[],At=new Map,Ut=[],Wt=new Map,Xt=[],Yt=new Map,Kt=(0===t[22]?t[24]._("Add files"):t[24]._n("x files queued",t[22]))+"",Vt=t[24]._n("x files",t[11].length)+"",Qt=t[24]._("Abort")+"",Zt=pt.humanSize(t[21])+"",Gt=t[11];const Jt=t=>t[73].id;for(let e=0;e<Gt.length;e+=1){let n=Be(t,Gt,e),i=Jt(n);At.set(i,Pt[e]=$e(i,n))}let te=t[17],ee=[];for(let e=0;e<te.length;e+=1)ee[e]=ze(Le(t,te,e));let ne=t[11];const ie=t=>t[73].id;for(let e=0;e<ne.length;e+=1){let n=Se(t,ne,e),i=ie(n);Wt.set(i,Ut[e]=Pe(i,n))}let re=t[11];const ae=t=>t[73].id;for(let e=0;e<re.length;e+=1){let n=Te(t,re,e),i=ae(n);Yt.set(i,Xt[e]=Qe(i,n))}let oe=!1===t[0].immediateUpload&&Ze(t),se=!0===t[19]&&Ge(t),le=!0===t[20]&&Je(t);const ce=new De({props:{isOpen:t[14],uFile:t[12],errors:t[18]}});return{c(){e=b("div"),n=b("div");for(let t=0;t<Pt.length;t+=1)Pt[t].c();i=x(),a=b("div"),o=b("div");for(let t=0;t<ee.length;t+=1)ee[t].c();s=x(),l=b("div"),u=b("div"),u.textContent=""+t[24]._("Select files"),d=x(),h=b("div"),p=b("button"),f=b("i"),T=x(),S=b("button"),L=b("i"),$=x(),z=b("div"),j=b("div"),q=b("div"),F=b("div"),F.textContent=""+t[24]._("Filename"),N=x(),I=b("div"),I.textContent=""+t[24]._("Status"),R=x(),H=b("div"),H.textContent=""+t[24]._("Size"),P=x(),A=b("div"),U=x(),W=b("div"),X=b("div"),X.textContent=""+t[24]._("Drag files here."),Y=x(),K=b("ul");for(let t=0;t<Ut.length;t+=1)Ut[t].c();V=x(),Q=b("div"),Z=b("div"),Z.textContent=""+t[24]._("Drag files here."),nt=x(),it=b("div");for(let t=0;t<Xt.length;t+=1)Xt[t].c();ct=x(),ut=b("div"),dt=b("div"),ht=b("button"),ft=b("i"),mt=x(),gt=b("span"),vt=w(Kt),bt=x(),oe&&oe.c(),wt=x(),xt=b("div"),Ct=b("span"),Et=b("span"),_t=w(Vt),Mt=x(),kt=b("span"),se&&se.c(),Ot=x(),le&&le.c(),Dt=x(),Tt=b("button"),St=b("i"),Lt=x(),Bt=w(Qt),$t=x(),zt=b("span"),jt=w(Zt),qt=x(),Ft=b("div"),Nt=b("input"),It=x(),ot(ce.$$.fragment),M(n,"class","hidden-inputs"),O(n,"display","none"),M(o,"class","error-container-item svelte-yfqure"),M(a,"class","error-container svelte-yfqure"),M(u,"class","left"),M(f,"class","fas fa-list-ul btn-view-text svelte-yfqure"),M(p,"class",C=c(t[9])+" svelte-yfqure"),M(L,"class","far fa-image btn-view-image svelte-yfqure"),M(S,"class",B=c(t[10])+" svelte-yfqure"),M(h,"class","right svelte-yfqure"),M(l,"class","header svelte-yfqure"),M(F,"class","cell-name svelte-yfqure"),M(I,"class","cell-status svelte-yfqure"),M(H,"class","cell-size svelte-yfqure"),M(A,"class","cell-action svelte-yfqure"),M(q,"class","dropzone-text-header svelte-yfqure"),M(X,"class","dropzone-droptext svelte-yfqure"),M(K,"class","fileuploader-item-container svelte-yfqure"),M(W,"class","dropzone-text-container svelte-yfqure"),M(j,"class","dropzone-text svelte-yfqure"),D(j,"visible","text"===t[13]),M(Z,"class","dropzone-droptext svelte-yfqure"),M(it,"class","filelist fileuploader-item-container svelte-yfqure"),M(Q,"class","dropzone-image svelte-yfqure"),D(Q,"visible","image"===t[13]),M(z,"class","dropzone svelte-yfqure"),M(ft,"class","btn-add-file fas fa-plus-circle svelte-yfqure"),M(gt,"class","btn-add-file"),M(ht,"class",yt=c(t[7])+" svelte-yfqure"),M(dt,"class","left"),M(Et,"class","text-file"),M(Ct,"class","footer-info svelte-yfqure"),M(kt,"class","footer-info global-percent-upload svelte-yfqure"),M(St,"class","fas fa-ban btn-abort-upload svelte-yfqure"),M(Tt,"class","btn-abort-upload svelte-yfqure"),O(Tt,"display",t[16]?"inline-block":"none"),M(zt,"class","footer-info global-size svelte-yfqure"),M(xt,"class","right svelte-yfqure"),M(ut,"class","footer svelte-yfqure"),M(Nt,"class","input-file svelte-yfqure"),Nt.disabled=!0,M(Nt,"type","file"),M(Nt,"name",t[1]),Nt.multiple=t[2],M(Ft,"class","hidden"),O(Ft,"display","none"),M(e,"class","fileuploader-container svelte-yfqure")},m(c,v,y){g(c,e,v),m(e,n);for(let t=0;t<Pt.length;t+=1)Pt[t].m(n,null);m(e,i),m(e,a),m(a,o);for(let t=0;t<ee.length;t+=1)ee[t].m(o,null);m(e,s),m(e,l),m(l,u),m(l,d),m(l,h),m(h,p),m(p,f),m(h,T),m(h,S),m(S,L),m(e,$),m(e,z),m(z,j),m(j,q),m(q,F),m(q,N),m(q,I),m(q,R),m(q,H),m(q,P),m(q,A),m(j,U),m(j,W),m(W,X),m(W,Y),m(W,K);for(let t=0;t<Ut.length;t+=1)Ut[t].m(K,null);t[66](K),m(z,V),m(z,Q),m(Q,Z),m(Q,nt),m(Q,it);for(let t=0;t<Xt.length;t+=1)Xt[t].m(it,null);t[69](it),t[70](z),m(e,ct),m(e,ut),m(ut,dt),m(dt,ht),m(ht,ft),m(ht,mt),m(ht,gt),m(gt,vt),m(dt,bt),oe&&oe.m(dt,null),m(ut,wt),m(ut,xt),m(xt,Ct),m(Ct,Et),m(Et,_t),m(xt,Mt),m(xt,kt),se&&se.m(kt,null),m(kt,Ot),le&&le.m(kt,null),m(xt,Dt),m(xt,Tt),m(Tt,St),m(Tt,Lt),m(Tt,Bt),m(xt,$t),m(xt,zt),m(zt,jt),m(e,qt),m(e,Ft),m(Ft,Nt),t[71](Nt),g(c,It,v),st(ce,c,v),Rt=!0,y&&r(Ht),Ht=[E(p,"click",_(t[62])),E(S,"click",_(t[63])),E(ht,"click",_(t[28])),E(Tt,"click",_(t[29])),E(Nt,"change",t[72])]},p(t,e){if(2050&e[0]){const i=t[11];Pt=at(Pt,e,Jt,1,t,i,At,n,rt,$e,null,Be)}if(131072&e[0]){let n;for(te=t[17],n=0;n<te.length;n+=1){const i=Le(t,te,n);ee[n]?ee[n].p(i,e):(ee[n]=ze(i),ee[n].c(),ee[n].m(o,null))}for(;n<ee.length;n+=1)ee[n].d(1);ee.length=te.length}if((!Rt||512&e[0]&&C!==(C=c(t[9])+" svelte-yfqure"))&&M(p,"class",C),(!Rt||1024&e[0]&&B!==(B=c(t[10])+" svelte-yfqure"))&&M(S,"class",B),83888129&e[0]|1&e[1]){const n=t[11];Ut=at(Ut,e,ie,1,t,n,Wt,K,rt,Pe,null,Se)}if(8192&e[0]&&D(j,"visible","text"===t[13]),67110913&e[0]|1&e[1]){const n=t[11];Xt=at(Xt,e,ae,1,t,n,Yt,it,rt,Qe,null,Te)}8192&e[0]&&D(Q,"visible","image"===t[13]),(!Rt||4194304&e[0])&&Kt!==(Kt=(0===t[22]?t[24]._("Add files"):t[24]._n("x files queued",t[22]))+"")&&k(vt,Kt),(!Rt||128&e[0]&&yt!==(yt=c(t[7])+" svelte-yfqure"))&&M(ht,"class",yt),!1===t[0].immediateUpload?oe?oe.p(t,e):(oe=Ze(t),oe.c(),oe.m(dt,null)):oe&&(oe.d(1),oe=null),(!Rt||2048&e[0])&&Vt!==(Vt=t[24]._n("x files",t[11].length)+"")&&k(_t,Vt),!0===t[19]?se?(se.p(t,e),524288&e[0]&&tt(se,1)):(se=Ge(t),se.c(),tt(se,1),se.m(kt,Ot)):se&&(G(),et(se,1,1,()=>{se=null}),J()),!0===t[20]?le?(le.p(t,e),1048576&e[0]&&tt(le,1)):(le=Je(t),le.c(),tt(le,1),le.m(kt,null)):le&&(G(),et(le,1,1,()=>{le=null}),J()),(!Rt||65536&e[0])&&O(Tt,"display",t[16]?"inline-block":"none"),(!Rt||2097152&e[0])&&Zt!==(Zt=pt.humanSize(t[21])+"")&&k(jt,Zt),(!Rt||2&e[0])&&M(Nt,"name",t[1]),(!Rt||4&e[0])&&(Nt.multiple=t[2]);const i={};16384&e[0]&&(i.isOpen=t[14]),4096&e[0]&&(i.uFile=t[12]),262144&e[0]&&(i.errors=t[18]),ce.$set(i)},i(t){Rt||(tt(se),tt(le),tt(ce.$$.fragment,t),Rt=!0)},o(t){et(se),et(le),et(ce.$$.fragment,t),Rt=!1},d(n){n&&v(e);for(let t=0;t<Pt.length;t+=1)Pt[t].d();y(ee,n);for(let t=0;t<Ut.length;t+=1)Ut[t].d();t[66](null);for(let t=0;t<Xt.length;t+=1)Xt[t].d();t[69](null),t[70](null),oe&&oe.d(),se&&se.d(),le&&le.d(),t[71](null),n&&v(It),lt(ce,n),r(Ht)}}}function en(t){let e=t.target.closest(".error-item");null!==e&&e.remove()}function nn(t,e="id"){let n=[],i=t.children;for(let t of i){let i="data-"+e,r=t.getAttribute(i);if(!r)throw new Error("No element found with attribute "+i+". This is a setup error, please fix it now.");n.push(r)}return n}function rn(t,e,n){let{options:i={}}=e;i=pt.extend(!0,{useBootstrap:!1,lang:"eng",maxFile:1,dropzoneOverClass:"dropzone-hover",urls:[],name:"the_file",maxFileSize:-1,maxFileNameLength:64,mimeType:null,allowedFileExtension:null,uploadItemName:"file",onServerError(t){console.log(t)},isExternalUrl:t=>!1,serverUrl:"/upload.php",payload:{},immediateUpload:!1,useVirtualServer:!1,useDelete:!1,useKeepOriginalImage:!1,useFileEditor:!1,fileEditor:{fileExtensionCanBeUpdated:!1,useDirectory:!1,directory:"",directoryCanBeUpdated:!0,usePrivacy:!1,useTags:!1,allowCustomTags:!0,availableTags:[],nbTagsAllowed:5,useImageEditor:!1}},i);let r,a,o,s,l=1,c=i.name,u=!1;if(i.maxFile>1&&(c+="[]",u=!0),!1===pt.arrayKeyExists(i.lang,FileUploader._langs))throw new Error("Lang not available: "+i.lang);let d=FileUploader._langs[i.lang],h=new bt;h.setDefaultLang(i.lang),h.addDictionary(i.lang,d);let p=new vt;p.setTranslator(h),p.init(i);let f=new yt,m=null,g="btn-add-file",v="btn-start-upload",y="btn-view-text",b="btn-view-image";!0===i.useBootstrap&&(g+=" btn btn-outline-dark btn-sm",v+=" btn btn-outline-dark btn-sm",y+=" btn btn-info btn-sm",b+=" btn btn-info btn-sm");let w=[],x=null,C="image",E=!1,_=0,M=!1,k=[],O=[],D=i.urls,T=!0,S=!1;var L,B,$;function z(t){n(13,C=t)}function j(t,e){let n=i.fileEditor;if("tags"in i)for(;i.tags.length>n.nbTagsAllowed;)i.tags.pop();return pt.extend({id:F(),url:null,name:t.name,directory:n.directory,file:t,status:0,size:t.size,type:t.type,progress:0,is_private:!1,is_user_data:!1,tags:[],keep_original:pt.toInt(i.useKeepOriginalImage),is_loading:!1},e)}function F(){return"id"+l++}function I(t){n(11,w=[...w,t])}function R(t){for(let e in w){let i=w[e];if(t.id===i.id){n(11,w[e]=t,w);break}}}function H(t,e){let r=p.test(e);!0===r?(t.file=e,t.size=e.size,t.type=e.type,t.name=e.name,t.status=2,t.keep_original=pt.toInt(i.useKeepOriginalImage),t.__preserveOriginalUrl=!0,n(12,x=t),R(t),!0===i.immediateUpload&&setTimeout((async function(){await nt({action:"update",url:t.url,original_url:t.original_url});let e=ut(x.id);n(12,x=e)}),1)):K(r)}async function P(t,e,r){let{cropped:a,dropped:o,original:s}=r;t.is_loading=!0,n(12,x=t);let l=!0===a||!0===o;t.keep_original=pt.toInt(!0===o&&!1===s&&!1===a);let c,u=i.isExternalUrl(t.url);if(t=pt.extend(t,e),!0===u||!0===l)n(16,M=!0),c=await it(t,{action:"update",url:t.url},{singleFile:!0}),n(16,M=!1),ct();else{var d=pt.extend({},i.payload,{action:"update",url:t.url,filename:t.name,directory:t.directory,tags:t.tags,is_private:pt.toInt(t.is_private)});let e=await Q(d);c=await rt(t,e),c.file=t.file,c.original_url=t.original_url,c.type=t.type,c.size=t.size}!1!==c&&(c.is_loading=!1,R(c))}async function A(t,e=!0){for(let r in w){let a=w[r];if(t===a.id){if(!0!==e||!1!==i.isExternalUrl(a.url)){pt.removeEntryByIndex(w,r),n(11,w);break}{a.is_loading=!0,n(11,w);let t=await Q({action:"delete",url:a.url});if(a.is_loading=!1,!0===G(t)){pt.removeEntryByIndex(w,r),n(11,w);break}}}}}function U(t){let e=t,n=t.split("/").pop(),r={id:F(),status:0,url:t,name:n};I(r),!0===i.useFileEditor&&(t=pt.url_merge_params(t,{m:1})),fetch(t).then(a=>{a.ok?a.blob().then(t=>{let o=function(t,e){return t.lastModifiedDate=new Date,t.name=e,t}(t,n),s={};!0===i.useFileEditor&&(s=gt.getPandaHeaders(a.headers)),R(j(o,pt.extend(s,{status:1,url:e,id:r.id})))}):tt("An error occurred with the request for url "+t)})}async function W(t){n(3,r.disabled=!0,r);var e=t.length;for(let n=0;n<e;n++){let e=t[n],i=p.test(e);if(!0===i){I(j(e,{status:2})),await X()}else Y(i)}!0===i.immediateUpload&&setTimeout((function(){nt()}),1)}async function X(){if(-1!==i.maxFile&&w.length>i.maxFile){let t=w.length-i.maxFile;for(;t>0;){t--;let e=w[0];await A(e.id)}}}function Y(t){!0===E?K(t):n(17,k=[...k,t])}function K(t){n(18,O=[...O,t])}function V(t){let e=[],i={};w.forEach(t=>{i[t.id]=t}),t.forEach(t=>{e.push(i[t])}),n(11,w=e)}async function Q(t,e=!1){t=pt.extend({},i.payload,t);var n=await pt.post(i.serverUrl,t).catch(t=>{tt("An error occurred with the request: "+t)});if(!0===n.ok)return!0===e?n:await n.json().catch(t=>{Y(t.toString())});tt("The server status code was "+n.status)}async function Z(){return!0===G(await Q({action:"reset"}))&&(et(),!0)}function G(t){return!0===J(t)||(tt(t.error),!1)}function J(t){return!(!pt.isPlainObject(t)||!("type"in t)||"success"!==t.type)}function tt(t){Y(t)}function et(){n(11,w=[]);let t=i.maxFile;D.forEach(e=>{t>0&&(U(e),t--)})}async function nt(t={}){if(ht>0){n(16,M=!0),f.registerItems(w);for(let[e,i]of w.entries()){let r=i.id;if(2===i.status){i.is_loading=!0,n(11,w);let a=await it(i,t);!1!==a?(a.is_loading=!1,n(11,w[e]=a,w)):A(r,!1)}}n(16,M=!1),ct()}}async function it(t,e={},r={}){let a=null,o=r.singleFile||!1;var s=pt.extend({},i.payload,{action:"add",filename:t.name,directory:t.directory,tags:t.tags,is_private:pt.toInt(t.is_private),keep_original:pt.toInt(t.keep_original)},e);!1===pt.mimeIsImage(t.type)&&(s.keep_original=0),s.useChunks=1,m=new xt({serverUrl:i.serverUrl,onChunkAborted:(e,n,i)=>{ot(t)},onChunkLoaded:(e,i,r,a)=>{let s=Math.round(i/r*100,2),l=t.id;!1===o?(f.addProgress(l,s),n(15,_=f.getPercent().toFixed(2))):n(15,_=s),at(l,s)},async onChunkResponseReceived(t){try{return a=await t.json(),!0===J(a)||a.error}catch(t){return t.toString()}}});try{let e=await m.sendByChunks(t.file,s,{start:0});a=await e.json()}catch(t){a={type:"error",error:t}}return await rt(t,a)}async function rt(t,e){if(!0===G(e)){if(delete e.type,!0===t.__preserveOriginalUrl){let n=t.original_url;(t=pt.extend(t,e)).original_url=n,delete t.__preserveOriginalUrl}else t=pt.extend(t,e);if(!0===pt.mimeIsImage(t.type)){let e=t.url;!0===i.useVirtualServer&&(e+="&v=1");let n=await pt.fetchBlob(e);t.file=n,t.size=n.size,t.type=n.type}return t.status=3,null!==t.original_url&&(!0===i.useVirtualServer&&(t.original_url=pt.url_merge_params(t.original_url,{v:1})),t.keep_original=0),t}return!1}function at(t,e){let i=2;for(let r in w){let a=w[r];if(t===a.id&&(a.progress=e,n(11,w),i--,0===i))break;if(null!==x&&t===x.id&&(n(12,x.progress=e,x),n(12,x),i--,0===i))break}}function ot(t){A(t.id)}function st(t){let e=ut(t);n(12,x=e),n(14,E=!0)}function lt(){n(14,E=!1)}function ct(){setTimeout(()=>{!0===T?(n(19,T=!1),setTimeout(()=>{n(15,_=0),n(16,M=!1),n(20,S=!0)},500)):(n(20,S=!1),setTimeout(()=>{n(15,_=0),n(16,M=!1),n(19,T=!0)},500))},2e3)}function ut(t){for(let e of w)if(t===e.id)return e;throw new Error("uFile not found with id: "+t)}L=async()=>{new wt({container:a,cssClass:i.dropzoneOverClass,onDrop:t=>{W(t)}}).start();let t=ne([s]),e=ne([o]);if(t.on("drop",()=>{V(nn(s))}),e.on("drop",()=>{V(nn(o))}),!0===i.useVirtualServer){await Z();let t=a.closest("form");null!==t&&t.addEventListener("reset",async()=>{await Z()})}else et()},q().$$.on_mount.push(L),B="fileUploader",$={onCloseFileEditorBtnClicked:lt,onFileEditorFileDropped:H,onFileEditorUpdated:P,fileEditorOptions:Object.assign(i.fileEditor,{dropzoneOverClass:i.dropzoneOverClass,useKeepOriginalImage:i.useKeepOriginalImage,useBootstrap:i.useBootstrap})},q().$$.context.set(B,$);let dt,ht,ft;return t.$set=t=>{"options"in t&&n(0,i=t.options)},t.$$.update=()=>{2048&t.$$.dirty[0]&&n(21,dt=function(t){let e=0;return t.forEach(t=>{t.size&&(e+=t.size)}),e}(w)),2048&t.$$.dirty[0]&&n(22,ht=function(t){let e=0;return t.forEach(t=>{2===t.status&&e++}),e}(w)),4194305&t.$$.dirty[0]&&n(23,ft=!1===i.immediateUpload&&ht>0)},[i,c,u,r,a,o,s,g,v,y,b,w,x,C,E,_,M,k,O,T,S,dt,ht,ft,h,z,A,W,function(){n(3,r.disabled=!1,r),r.click()},function(){null!==m&&(m.abort(),ct())},nt,st,l,m,d,p,f,D,j,F,I,R,H,P,U,X,Y,K,V,Q,Z,G,J,tt,et,it,rt,at,ot,lt,ct,ut,()=>z("text"),()=>z("image"),t=>st(t.id),t=>A(t.id),function(t){N[t?"unshift":"push"](()=>{n(5,o=t)})},t=>st(t.id),t=>A(t.id),function(t){N[t?"unshift":"push"](()=>{n(6,s=t)})},function(t){N[t?"unshift":"push"](()=>{n(4,a=t)})},function(t){N[t?"unshift":"push"](()=>{n(3,r=t)})},t=>W(t.target.files)]}class an extends dt{constructor(t){super(),ut(this,t,rn,tn,o,{options:0},[-1,-1,-1])}}window.FileUploader=function(t){return new an(t)},FileUploader._langs={},FileUploader.hasLang=function(t){return t in FileUploader._langs},FileUploader.addLang=function(t,e){FileUploader._langs[t]=e}}();
//# sourceMappingURL=bundle.js.map
